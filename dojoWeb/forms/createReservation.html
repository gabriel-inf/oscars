<html>
<head>
    <script type="text/javascript>
        dojo.addOnLoad(function(){
            var w = dojo.byId("reservationLogin");
            w.value= oscarsState.login;
        });
        dojo.addOnLoad(function(){
            dojo.xhrPost({
                url: 'servlet/CreateReservationForm',
                handleAs: "json-comment-filtered",
                load: oscars.Form.handleReply,
                error: oscars.Form.handleError,
                form: dojo.byId("createReservationForm")
            });
        });
    </script>
</head>

<form id="createReservationForm" method="POST">

<!-- currently just used to load form once -->
<input type="hidden" name="login" id="reservationLogin" />
<input type="hidden" name="startSeconds" id="hiddenStartSeconds" />
<input type="hidden" name="endSeconds" id="hiddenEndSeconds" />

<p>Required inputs are bordered in green.  Ranges or types of valid
entries are given in parentheses after the default values, if any.
Click on the boxes associated with the start and end dates to bring
up a calendar widget.  The reservation time slot defaults to
now, and now + 4 minutes, respectively, if you leave the dates and
times empty.</p>

<!-- NOTE:  there will be flicker if user is authorized.  Would need to
            create everything programmatically to avoid. -->
<div id="authorizedWarningDisplay" style="display: none">
<p>WARNING: Entering a value in a red-outlined field may change default
routing behavior for the selected flow.  Note that the path field will expand
to the number of lines occurring in the hops list.
</p>
</div>

<table width="90%">
  <tbody>
  <tr>
    <td>
      <button dojoType="dijit.form.Button" id="createReservation">
         Create Reservation
         <script type="dojo/method" event="onClick">
            var legal = oscars.Form.checkDateTimes();
            if (legal) {
                dojo.xhrPost({
                  url: 'servlet/CreateReservation',
                  handleAs: "json-comment-filtered",
                  load: oscars.Form.handleReply,
                  error: oscars.Form.handleError,
                  form: dojo.byId("createReservationForm")
                });
            }
        </script>
      </button>
    </td>
    <td>
      <input type="reset" value="Reset form fields"></input>
    </td>
  </tr>
  <tr>
    <td>Source</td>
    <td class="required">
      <input type="text" name="source"
             dojoType="dijit.form.ValidationTextBox"
             promptMessage="Enter the source of the circuit"
             required="true" />
    </td>
    <td>( Host name or IP address[:port] )</td>
  </tr>
  <tr>
    <td>Destination</td>
    <td class="required">
      <input type="text" name="destination"
             dojoType="dijit.form.ValidationTextBox" 
             promptMessage="Enter the destination of the circuit"
             required="true" />
    </td>
    <td>( Host name or IP address[:port] )</td>
  </tr>
  <tr>
    <td>Bandwidth (Mbps)</td>
    <td class="required">
      <input type="text" name="bandwidth" id="bandwidth"
           dojoType="dijit.form.NumberTextBox"
           constraints="{min:10,max:10000,places:0}"
           promptMessage="Enter a value between 10 and 10000"
           required="true"
           invalidMessage="Invalid bandwidth." />
     </td>
     <td>( 10-10000 )</td>
  </tr>
  <tr>
    <td>Purpose of reservation</td>
    <td class="required">
       <input type="text" name="description" id="reservationDescription"
              dojoType="dijit.form.ValidationTextBox"
              regExp="[\w\s]+"
              promptMessage="Please enter the purpose for this reservation"
              invalidMessage="You must enter the purpose for this reservation"
              required="true" />
    </td>
    <td>( For our records )</td>
  </tr>

    <tr id="authorizedPathDisplay" style="display:none">
      <td>Path</td>
      <td class="warning">
        <textarea name="explicitPath" id="explicitPath"
                  dojoType="dijit.form.Textarea">
        </textarea>
      </td>
      <td>(series of hops)</td>
    </tr>

  <tr>
    <td>Start date</td>
    <td><input dojoType="dijit.form.DateTextBox" name="startDate"
               id="startDate" />
    </td>
    <td id="startDateDefault">MM/DD/YYYY</td>
  </tr>
  <!-- TimeTextBox is beta as of 1.0.2 and does not include all documented
       features.  It doesn't allow very fine grained control, and doesn't
       send the browser's time zone by default in the time.  The dojo.date
       modules that could change this default behavior are rather opaque to
       me. -->
  <tr><td>Start time</td>
      <td><input dojoType="dijit.form.ValidationTextBox" name="startTime"
             id="startTime"
             regExp="[0-2]?[\d]:[0-5][\d]"
             promptMessage="Enter the start time in format HH:MM"
             invalidMessage="Invalid format:  use HH:MM" /></td>
    <td id="startTimeDefault">HH:MM</td>
  </tr>
  <tr><td>End date</td>
    <td><input dojoType="dijit.form.DateTextBox" name="endDate"
               id="endDate" /></td>
    <td id="endDateDefault">MM/DD/YYYY</td>
  </tr>
  <tr><td>End time</td>
    <td><input dojoType="dijit.form.ValidationTextBox" name="endTime"
             id="endTime"
             regExp="[0-2]?[\d]:[0-5][\d]"
             promptMessage="Enter the end time in format HH:MM"
             invalidMessage="Invalid format:  use HH:MM" /></td>
    <td id="endTimeDefault">HH:MM</td>
  </tr>

  <tr><td colspan="3"> </td></tr>
  <tr><td colspan="3"><strong>Layer 2 parameters</strong></td></tr>
  <tr><td>VLAN</td>
    <td>
      <input type="text" dojoType="dijit.form.TextBox" name="vlanTag"></input>
    </td>
    <td>tag, or range, e.g. 3000-3100</td></tr>
  <tr><td>Source Port</td>
    <td colspan="2">
      <select name="tagSrcPort">
        <option value="Tagged" selected="selected">Tagged</option>
        <option value="Untagged">Untagged</option>
      </select>
    </td>
  </tr>
  <tr><td>Destination Port</td>
    <td colspan="2">
      <select name="tagDestPort">
        <option value="Tagged" selected="selected">Tagged</option>
        <option value="Untagged">Untagged</option>
      </select>
    </td>
  </tr>

  <tr><td colspan="3"> </td></tr>
  <tr><td colspan="3"><strong>Layer 3 parameters</strong></td></tr>
  <tr><td>Source port</td>
    <td><input type="text" dojoType="dijit.form.TextBox" name="srcPort"
               maxlength="5" >
        </input>
    </td>
    <td>(1024-65535)</td></tr>
  <tr><td>Destination port</td>
    <td><input type="text" dojoType="dijit.form.TextBox" name="destPort"
               maxlength="5" >
    </input></td>
    <td>(1024-65535)</td>
  </tr>
  <tr><td>Protocol</td>
    <td><input type="text" dojoType="dijit.form.TextBox" name="protocol">
        </input></td>
        <td>(0-255, or string)</td></tr>
  <tr><td>Differentiated service code point</td>
    <td><input type="text" dojoType="dijit.form.TextBox" name="dscp"
                maxlength="2">
    </input></td>
    <td>(0-63)</td>
  </tr>

</tbody>
</table>
</form>
</html>
