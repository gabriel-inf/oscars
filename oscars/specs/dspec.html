<html>
<title>OSCARS Reservation Manager Design Specification</title>
</head>
<body>
<h2>OSCARS Reservation Manager Design Specification</h2>

<em>David Robertson, Chin Guok<br/>
ESnet</em><br/><br/>

February 7, 2005</br>

<hr>

<h3>Introduction</h3>

<p>This document focuses on the design decisions made for satisfying the
first year <a href="fspec.html">requirements</a> for the reservation manager
(RM) portion of <a href="http://www.es.net/oscars">OSCARS</a>.  Non-first
year decisions are followed by a parenthesized indicator of the year.</p>

<p>Portions of this document are taken from the OSCARS
<a href="http://www.es.net/oscars/documents/OSCARS.pdf">project summary</a>.</p>

<p>The primary design decision is to implement the authentication,
authorization, and auditing subsystem (AAAS) and bandwidth scheduler
subsystem (BSS) components as Grid services.  Web services (WS) standards will
be used wherever possible, including SOAP for transport and WSDL for service
description.</p>

<p>The AAAS component of the RM handles external service requests and enforces
access.  The BSS will be implemented as a Grid service, but will only be
accessible via the AAAS.  The AAAS and BSS will not necessarily have to run on
the same machine.  The path setup subsystem (PSS) will be implemented as a
library linked in by the BSS.  Different instances of the RM, for example in
different organizations, will communicate via their respective AAAS.</p>


<h3>Transport</h3>

<p><a href="http://www.w3.org/TR/soap/">SOAP</a> messages will be used for
communication between all grid service components.  In particular,
identical SOAP messages to the AAAS will be generated, whether using the manual
interface (y1), or the API (y2).</p>

<p>Grid component services will be described via the Web Service Definition
Language (<a href="http://www.w3.org/TR/wsdl">WSDL</a>).
WSDL provides for definitions of data types for message arguments
using XML Schema, and definitions of request and response messages.</p>


<h3>User interface</h3>

<p>The manual user interface to the RM will be a Web-Based User Interface
(WBUI), i.e. a browser.  The specific mode of interaction will be via
<a href="http://www.php.net/">PHP</a> forms.  The forms will use the
<a href="http://www.nersc.gov/nusers/accounts/nim/users_manual/getting_started.php">NIM</a>
Web pages as a template, where NIM is the resource allocation and accounting
system for NERSC.  However, database access will not be done directly
via PHP, as in NIM.</p>

<p>To request a reservation, a form will be provided for the user to set
a start and end time (minimum one hour), the bandwidth requested, and
the end points of a circuit.  A disclaimer will be on the form indicating
that if the transit path across ESnet has more than one ingress point, a
full traceroute must be provided to ensure that the requested bandwidth is
actually available.  An input field for the traceroute will be provided.</p>

<p>An input field indicating that a user wants to set up a bidirectional
path will be provided, as well as a field for a return email address if
the user wants to receive notifications.</p>

<p>The response to the request will show the full traceroute that was set
up, if the reservation was set up immediately.  Otherwise a message will
be displayed saying that the reservation request was queued.</p>

<p>A form will be provided for users to see all the reservations they have made.
A search filter will be provided on the form to narrow the reservations, for
example by a specific date.  Reservation identifiers will include the date,
the user name, and a sequence number for that date.</p>

<p>User-requested notifications will be done via email.</p>

<p>The <a href="http://dsd.lbl.gov/gtg/projects/pyGridWare/">pyGridWare</a>
API will be used by client application programs.  pyGridWare is a
<a href="http://www.python.org/">Python</a> implementation of the
<a href="http://www.oasis-open.org/specs/index.php">WS-Resource</a>
Web services framework (y2).</p>


<h3>Security</h3>

<p>Security is absolutely essential.  The impact of an abuse could be very
large.  A DoS attack could prevent reservations from being processed.  If the
service is compromised, the WAN may be disabled.</p>

<p>The AAAS Web server will only allow connections via SSL.</p>

<p>SOAP messages to the AAAS will be signed, including the user's
authenticated identifier.</p>

<p>The only user able to access the database server (see next section) will
be the AAAS and administrators.  The BSS will only accept connections from the
AAAS.</p>

<p>The RM will use ESnet production tools to monitor usage.</p>


<h3>AAAS</h3>

<p>The AAAS will consist of a Web server, a set of PHP forms, a database, and a
front end to that database.  (PHP is embedded in HTML, but runs on the server
side.  Only the result of a PHP method is visible to a client browser.)</p>

<p>The Apache2 Web server will be used, and will only accept connections
via SSL.   Initially it will only accept connections from ESnet hosts.
httpd processes will run as an unprivileged user without a login shell.</p>

<p>The MySQL database server will be used.  The database organization (tables,
constraints, etc.) will use the NIM database as a template.  The database will
run as an unprivileged user without a login shell.  The database will only
accept connections from a user designated to run the front end, and from ESnet
administrative users.</p>

<p>Before requests can be made via the WBUI, the user will use a form to 
authenticate via a user name and password, and a distinguished name (DN) if it
is different than the user name.  The DN will be used to retrieve a certificate
from the <a href="http://doegrids.org/">DOEGrids Certificate Service</a>.</p>

<p>Once the certificate is retrieved, forms incorporating PHP methods will be
used to handle user requests, incorporating that certificate in signed SOAP
messages sent to the front end.  The front end will access and modify the
database, and control the BSS, based on those requests (y1).  Requests made via
the API use pyGridWare methods to send signed SOAP messages to the front end
(y2).</p>

<p>Signed SOAP messages will be used for communication between the front end
and the BSS.</p>

<h3>BSS</h3>

<p>The BSS will use an open-source library (TBD) to handle calendaring in
conjunction with the AAAS MySQL database.  Triggers in the database will
cause the BSS to invoke the PSS library to set up and tear down connections.</p>

<p><em>NOTE:</em>  a large part of the functionality of the BSS and PSS
is post year one.</p>


<h3>PSS</h3>

<p>The PSS will use 
<a href="http://www.juniper.net/support/junoscript/">Junoscript</a>
to configure Juniper routers, and
<a href="http://www.shrubbery.net/rancid/">RANCID</a>
to configure Cisco routers.  The PSS will
set up the LSP, check for non-valid paths, and tear down the LSP.</p>

</body>
</html>


