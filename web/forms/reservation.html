<html>

<head>
    <script type="text/javascript">
      function postQuery() {
          dojo.xhrPost({
            url: 'servlet/QueryReservation',
            handleAs: "json-comment-filtered",
            load: oscars.Form.handleReply,
            error: oscars.Form.handleError,
            form: dojo.byId("reservationDetailsForm")
          });
      }
      function cancelReservation(dialogFields) {
          dojo.xhrPost({
            url: 'servlet/CancelReservation',
            handleAs: "json-comment-filtered",
            load: oscars.Form.handleReply,
            error: oscars.Form.handleError,
            form: dojo.byId("reservationDetailsForm")
          });
      }
    </script>
    <script type="text/javascript">
      function catchQuery(event) {
          if (event.keyCode == dojo.keys.ENTER) {
              postQuery();
              dojo.stopEvent(event);
          }
      }
      function initQuery(event) {
          dojo.connect(dijit.byId("gri").domNode, 'onkeypress', catchQuery);
      }
      dojo.connect(dijit.byId("reservationDetailsPane"), "onLoad", initQuery);
    </script>
</head>

<body>
<form id="reservationDetailsForm" method="POST">
<table>
  <tr>
    <td>GRI</td>
    <td>
      <input type="text" name="gri" id="gri"
             dojoType="dijit.form.ValidationTextBox"
             promptMessage="Enter a global reservation id" />
    </td>
    <td>
      <button dojoType="dijit.form.Button" id="queryReservation">
        REFRESH
      <script type="dojo/method" event="onClick">
          postQuery();
      </script>
      </button>
    </td>
    <td>
        <button dojoType="dijit.form.Button" id="cancelReservation"
                onclick="dijit.byId('cancelDialog').show();">
        CANCEL 
      </button>
    </td>
  </tr>
</table>
</form>

<!-- cancel dialog; note that doesn't seem to work inside a form -->
<div dojoType="dijit.Dialog" id="cancelDialog"
     style="display:none;" title="Are you sure you want to cancel?" execute="cancelReservation(arguments[0]);">
  <table>
    <tr>
      <td>
        <button dojoType="dijit.form.Button" type="submit">YES
        </button>
      </td>
    </tr>
  </table>
</div>
<table width="90%">
  <tr><td>Status</td><td id="statusReplace"></td></tr>
  <tr><td>User</td><td id="userReplace" /></tr>
  <tr><td>Description</td><td id="descriptionReplace" /></tr>
  <tr><td>Start time</td><td id="startTimeConvert" /></tr>
  <tr><td>End time</td><td id="endTimeConvert" /></tr>
  <tr><td>Created time</td> <td id="createdTimeConvert" /> </tr>
  <tr><td>Bandwidth (Mbps)</td><td id="bandwidthReplace" /></tr>
  <tr><td>Source</td><td id="sourceReplace" /></tr>
  <tr><td>Destination</td><td id="destinationReplace" /></tr>
  <tr><td>Intradomain hops</td><td id="pathReplace" /></tr>
  <tr><td>Interdomain path</td><td id="interPathReplace" /></tr>
  <tr class="layer2Replace"><td>VLAN</td><td id="vlanReplace" /></tr>

  <tr class="layer3Replace" style="display: none">
    <td>Source port</td><td id="sourcePortReplace" />
  </tr>
  <tr class="layer3Replace" style="display: none">
    <td>Destination port</td><td id="destinatonPortReplace" />
  </tr>
  <tr class="layer3Replace" style="display: none">
    <td>Protocol</td><td id="protocolReplace" />
  </tr>
  <tr class="layer3Replace" style="display: none">
    <td>DSCP</td><td id="dscpReplace" />
  </tr>

  <tr class="layer3Replace" style="display: none">
    <td>Burst limit</td><td id="burstLimitReplace" />
  </tr>
  <tr class="layer3Replace" style="display: none">
      <td>LSP</td><td id="lspClassReplace" />
  </tr>
</table>
</body>
</html>
