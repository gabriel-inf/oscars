<html>

<head>
    <script type="text/javascript">
      function catchQuery(event) {
          if (event.keyCode == dojo.keys.ENTER) {
              oscars.ReservationDetails.postQueryReservation(true);
              dojo.stopEvent(event);
          }
      }
      function initQuery(event) {
          dojo.connect(dijit.byId("newGri").domNode, 'onkeypress', catchQuery);
      }
      dojo.connect(dijit.byId("reservationDetailsPane"), "onLoad", initQuery);
    </script>
</head>

<body>
<form id="reservationDetailsForm" dojoType="dijit.form.Form">
<input type="hidden" name="gri" id="gri" />
<input type="hidden" name="modifyStartSeconds" id="modifyStartSeconds" />
<input type="hidden" name="modifyEndSeconds" id="modifyEndSeconds" />
<!-- not currently modifiable; hidden preferable to fields that look to
     be modifiable if the user had the proper authorization -->
<input type="hidden" name="modifyBandwidth" id="modifyBandwidth" />
<input type="hidden" name="modifyDescription" id="modifyDescription" />
<table>
  <tbody>
  <tr>
    <td>NEW GRI</td>
    <td>
      <input type="text" name="newGri" id="newGri"
             dojoType="dijit.form.ValidationTextBox"
             promptMessage="Enter a new GRI to retrieve its details" />
    </td>
    <td>
      <button dojoType="dijit.form.Button" id="queryReservation">
        QUERY 
      <script type="dojo/method" event="onClick">
          oscars.ReservationDetails.postQueryReservation(true);
      </script>
      </button>
    </td>
  </tr>
  </tbody>
</table>
<hr/>
<table>
  <tbody>
  <tr>
    <td>
      <button dojoType="dijit.form.Button" id="refreshReservation">
        REFRESH
      <script type="dojo/method" event="onClick">
          oscars.ReservationDetails.postQueryReservation(false);
      </script>
      </button>
    </td>
    <td>
      <button dojoType="dijit.form.Button" id="modifyReservation">
         MODIFY
         <script type="dojo/method" event="onClick">
             oscars.ReservationDetails.postModify();
         </script>
      </button>
    </td>
    <td>
        <button dojoType="dijit.form.Button" id="cancelReservation"
                onclick="dijit.byId('cancelDialog').show();">
        CANCEL 
      </button>
    </td>
    <td>
      <button dojoType="dijit.form.Button" id="cloneReservation">
         CLONE
         <script type="dojo/method" event="onClick">
             oscars.ReservationDetails.cloneReservation();
         </script>
      </button>
    </td>
  </tr>
  </tbody>
</table>

<table width="100%">
  <tbody>
  <tr>
      <!-- setting once sets for all in this column -->
      <td width="15%">GRI</td>
      <td id="griReplace"></td>
  </tr>
  <tr><td>Status</td><td id="statusReplace"></td></tr>
  <tr><td>User</td><td id="userReplace" /></tr>
  <tr><td>Description</td><td id="descriptionReplace" /></tr>
  <tr>
    <td>Start date</td>
    <td><input dojoType="dijit.form.DateTextBox" name="modifyStartDate"
               id="modifyStartDate" size="28" />
    </td>
  </tr>
  <tr><td>Start time</td>
      <td><input dojoType="dijit.form.ValidationTextBox" name="modifyStartTime"
             id="modifyStartTime"
             regExp="[0-2]?[\d]:[0-5][\d]"
             promptMessage="Enter the start time in format HH:MM"
             invalidMessage="Invalid format:  use HH:MM" size="28" /></td>
  </tr>
  <tr>
    <td>End date</td>
    <td><input dojoType="dijit.form.DateTextBox" name="modifyEndDate"
               id="modifyEndDate" size="28" />
    </td>
  </tr>
  <tr><td>End time</td>
    <td><input dojoType="dijit.form.ValidationTextBox" name="modifyEndTime"
             id="modifyEndTime"
             regExp="[0-2]?[\d]:[0-5][\d]"
             promptMessage="Enter the end time in format HH:MM"
             invalidMessage="Invalid format:  use HH:MM" size="28" /></td>
  </tr>
  <tr><td>Created time</td> <td id="createdTimeConvert" /> </tr>
  <tr><td>Bandwidth (Mbps)</td><td id="bandwidthReplace" /></tr>
  <tr><td>Source</td><td id="sourceReplace" /></tr>
  <tr><td>Destination</td><td id="destinationReplace" /></tr>
  <tr><td>Intradomain hops</td><td><table id="pathReplace"></table></td></tr>
  <tr><td>Interdomain path</td><td><table id="interPathReplace"></table></td></tr>
  <tr class="layer2Replace"><td>VLAN</td><td id="vlanReplace" /></tr>
  <tr class="layer2Replace"><td>Tagged</td><td id="taggedReplace" /></tr>

  <tr class="layer3Replace" style="display: none">
    <td>Source port</td><td id="sourcePortReplace" />
  </tr>
  <tr class="layer3Replace" style="display: none">
    <td>Destination port</td><td id="destinatonPortReplace" />
  </tr>
  <tr class="layer3Replace" style="display: none">
    <td>Protocol</td><td id="protocolReplace" />
  </tr>
  <tr class="layer3Replace" style="display: none">
    <td>DSCP</td><td id="dscpReplace" />
  </tr>

  <tr class="layer3Replace" style="display: none">
    <td>Burst limit</td><td id="burstLimitReplace" />
  </tr>
  <tr class="layer3Replace" style="display: none">
      <td>LSP</td><td id="lspClassReplace" />
  </tr>
  </tbody>
</table>
</form>
<!-- tooltip section for buttons -->
<div dojoType = "dijit.Tooltip" connectId="queryReservation" position="after">
    Gets the current status of the reservation identified by NEW GRI from the
    server.
</div>
<div dojoType = "dijit.Tooltip" connectId="refreshReservation" position="above">
    Gets the current status of the reservation from the server.  Any
    local modifications on the client are overwritten.
</div>
<div dojoType = "dijit.Tooltip" connectId="modifyReservation" position="above">
    Modifies the start time and end time for the reservation, if they are
    valid arguments.
</div>
<div dojoType = "dijit.Tooltip" connectId="cancelReservation" position="above">
    Cancels the current reservation if it is pending or active.
</div>
<!-- cancel dialog; note that doesn't seem to work inside a form -->
<div dojoType="dijit.Dialog" id="cancelDialog"
    style="display:none;" title="Are you sure you want to cancel?"
    execute="oscars.ReservationDetails.postCancelReservation(arguments[0]);">
  <table>
    <tr>
      <td>
        <button dojoType="dijit.form.Button" type="submit">YES
        </button>
      </td>
    </tr>
  </table>
</div>
</body>
</html>
