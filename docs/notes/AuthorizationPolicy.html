<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>Authorization Policy</title>
  <style type="text/css">
body {
margin-left: 7%;
margin-right: 5%;
}
  </style>
</head>
<body>
<h1>OSCARS Authorization Policy</h1>
<br>
<br>
<h2>Introduction</h2>
An authorization decision consists of deciding if an authenticated
entity should be allowed to perform some action on a controlled
resource. In OSCARS an authenticated entity may be a bandwidth user or
a bandwidth reservation service from another domain; the fundamental
resource is bandwidth though the domain, and the fundamental permission
is right to reserve some fraction of the available bandwidth. Since
available bandwidth is a limited resource, some finer control is needed
such as the maximum allowed bandwidth and duration. In addition, some
users of the system needed to request or suggest possible internal
routing for the data path.
<p>OSCARS chose to do attribute-based authorization primarily as a way
of
consolidating authorization policy to make it more understandable to
users and OSCARS administrators and partly in anticipation of
integrating with an external attribute provider such as Shibboleth or
VOMS. An attribute is some characteristic of a user, such as being a
member of some project, a holder of some role, or just his identity as
expressed as a registered user name or x.509 identity certificate. A
user gets the maximum of all the privileges granted to all of the
attributes that he has. </p>
<p>OSCARS is currently a self-contained system that defines who its
registered users are and what attributes each one has. As a result, it
needs to control who may manage users and their permissions, so users
become a controlled resource in addition to bandwidth. A final resource
is the internal topology, since we want control who may view the actual
topology and who may see and abstracted version of it. </p>
<p>The underlying guideline of our design and implementation is to keep
authorization policy and implementation as simple as possible. We have
tried to make the granularity of access decisions no finer than is
actually required, and have defined roles to consolidate sets of
permissions into sets that an actual user would need. Some of our
underlying assumptions are: Most users will get their permissions by
being members of a group/role, rather than by individual grants. The
number of group/roles will be small. The number of resources and
permissions will be small. While the implementation may scale to larger
numbers, the ability of the users and administrators to understand it
will not.
</p>
<p>We are currently intending to authorize a reservation that has been
forwarded to ESnet from an adjacent domain based on the attributes
assigned to that domain rather than the end user who is requesting the
reservation. Thus the number of users that must be registered with the
system can remain manageable. The name of the user is included in the
forwarded request, so it can be used for auditing purposes or can later
be used for authorization. <br>
</p>
<h2>Authorization policy requirements<br>
</h2>
The following paragraphs list the various actions that we want to
control with respect to the resources that OSCARS controls.<br>
<h3>Permissions with respect to users</h3>
<ul>
  <li>see own profile</li>
  <li>modify own profile</li>
  <li>list all users</li>
  <li>see all user profiles</li>
  <li>add/delete a user</li>
  <li>modify any user profile</li>
  <li>grant or remove authorizations for any user</li>
</ul>
<h3>Permissions with respect to bandwidth and reservations</h3>
<ul>
  <li>make unlimited reservation</li>
  <li>make reservation with bandwidth constraint</li>
  <li>make reservation with duration constraint</li>
  <li>make reservation with topology constraint</li>
  <li>list own reservations</li>
  <li>query own reservations</li>
  <li>cancel, modify own reservation</li>
  <li>signal own reservation</li>
  <li>list all reservations</li>
  <li>query any reservations</li>
  <li>cancel, modify any reservations </li>
  <li>signal any reservations</li>
</ul>
<span style="font-style: italic;">(signaling instantiates a reservation
by causing the appropriate commands to be sent to the routers involved)</span><br>
<h3>Permissions with respect to topology (not implemented yet)</h3>
<ul>
  <li>view abstract topology</li>
  <li>view real topology</li>
  <li>modify the topology</li>
</ul>
<h2>Policy Implementation</h2>
All access decisions are made by one of two methods which are called
from each place in the code that is about to grant some access. Access
policy is stored in a database, and an access decision is made by doing
table lookups based on the requestor, the action requested and the
resource. Authorizations may have constraints attached, in which case
the parameters of the request must meet the constraints. <br>
<br>
The following tables define the components for authorization:<br>
<ul>
  <li><span style="font-weight: bold;">users </span>&#8211; contains
an entry for each registered user, containing among other things, user
loginId, certSubject and certIssuer</li>
  <li><span style="font-weight: bold;">resources</span> &#8211; has
three entries: users, reservations, topology where topology is the
information about specific paths and routers.</li>
  <li><span style="font-weight: bold;">permissions</span> &#8211; has
five entries: list, query, create, modify and signal</li>
  <ul>
    <li><span style="font-weight: bold;">list</span> &#8211; shows
minimum information about a reservation or
user</li>
    <li><span style="font-weight: bold;">query</span> &#8211; shows all
information about a reservation or user</li>
    <li><span style="font-weight: bold;">create</span> &#8211; allows a
new user to added or a reservation to
be
created</li>
    <li><span style="font-weight: bold;">modify</span> &#8211; allows
deletion of a user and modification to a
user profile or cancellation or modification of a reservation.</li>
    <li><span style="font-weight: bold;">signal </span>&#8211; allows a
reservation to be instantiated.</li>
  </ul>
  <li><span style="font-weight: bold;"> attributes</span> &#8211; has entries
for attributes on which authorization
is
granted, e.g. ESnet-engineer, ESnet-developer, ESnet-admin, ESnet-user
and explicit user attributes for users with specific permissions, e.g.
user-david. There is an attribute-type field as well which is currently
not used.<br>
  </li>
  <li><span style="font-weight: bold;"> userAttributes</span> -
maps userIds to the attributes they
possess<br>
  </li>
  <li><span style="font-weight: bold;"> constraints</span> - The
current constraints that are supported are: <br>
    <ul>
      <li><span style="font-weight: bold;">max-bandwidth</span> (int),
applies to create and modify reservation</li>
      <li> <span style="font-weight: bold;">max-duration</span>
(int),
applies to create and modify reservation</li>
      <li> <span style="font-weight: bold;">specify-path-elements
(boolean), applies to create and modify
reservation</span></li>
      <li><span style="font-weight: bold;">specify-gri</span> (boolean)
can Global Reservation Identifier be
specified
on create reservation</li>
      <li> <span style="font-weight: bold;">all-users </span>(boolean),
applies to everything except create
reservation.</li>
    </ul>
  </li>
  <li><span style="font-weight: bold;">authorization</span> - combines
these elements into a row for each
action that each user is permitted. Each row consists of an attribute
id, a resource id, a permission id and optionally a constraint that
applies to this authorization. <br>
  </li>
</ul>
<br>
Users may have 1 or more attributes. Attributes are arbitrary strings,
defined in the attributes table, e.g. ESnet-Engineer, Atlas-PI,
CMS-member.<br>
<br>
The advantage of attributes is that it allows a set of authorizations
to be crafted which can then be applied to a class of users. Otherwise,
each time a new user registers, he must be given the correct and
complete set of permissions for whatever he wants to do. In our example
below, if a new network engineer, Ned, arrives, we would need to
duplicate all the authorization entries that Ed has for him. If we had
just entered those authorizations for "ESnet-Engineer" then we would
just need to assign Ned that attribute. It also makes the tables
smaller and thus may make it easier to understand the global picture of
who has what permissions.<br>
<br>
With attribute-based authorization, the access check will need to look
up user attributes, then look up authorizations for each attribute the
user has and merge them (take the maximum of the permissions). <br>
<br>
<h3>Default behaviors</h3>
<ul>
  <li>If a user has no entry in the user table, any attempted OSCARS
access
will be rejected immediately by Oscars:OscarsSkeleton:checkUser or
Servlets:AuthenticateUser</li>
  <li>If there are no attributes for the user in the userAttribute
table
access will be rejected immediately by Oscars:OscarsSkeleton:checkUser
or Servlets:AuthenticateUser</li>
  <li>If no attribute that the user possesses has an entry for the
resource/permission pair in the authorization table, the request is
denied.</li>
  <li>The constraint defaults are intended to be the most common cases,
not
the most restricted.</li>
  <ul>
    <li>If there is no max bandwidth constraint specified, there is
no limit
on the bandwidth that may be requested.</li>
    <li>If there is no duration constraint, unlimited duration and
persistent
reservations are allowed.</li>
    <li>If no all-users constraint is specified, the default is
false (only access to own information is allowed).</li>
    <li>If specify-path-elements is not specified, the default is
false and
no routers or hops may be input.</li>
    <li>If specify-gri is not specified, a GlobalResourceId may not
be
specified by the user, but will be automatically generated by the
CreateReservation code.</li>
    <br>
  </ul>
</ul>
<h3>Example Tables<br>
</h3>
We have users alice, bob, ed, david chin and andy. Alice and bob have
all their permissions individually assigned. Ed, chin and andy get all
their permissions from group attributes. David gets most permissions
from groups but has one more added individually.
<p>Note: &lt;ed&gt;,&lt;david&gt;,&lt;chin&gt;, &lt;andy&gt; are
indices
in the users table.<br>
&lt;ESnet-eng&gt;&lt;ESnet-dev&gt;,&lt;user-chin&gt;,&lt;user-david&gt;
are indices in the attributes table.<br>
A user would only need an "id-entry" in the attribute table if some
authorization was to be granted explicitly to him. It is probable that
a user will get all his authorizations based on group attributes.<br>
</p>
<p><span style="font-weight: bold;">attributes Table</span></p>
<table style="text-align: left; width: 616px; height: 220px;" border="1"
 cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td style="vertical-align: top;">id (int)</td>
      <td style="vertical-align: top;">attribute name (string) <br>
      </td>
      <td style="vertical-align: top;">attribute type (int)</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">1<br>
      </td>
      <td style="vertical-align: top;">ESnet-engineer<br>
      </td>
      <td style="vertical-align: top;">group</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">2<br>
      </td>
      <td style="vertical-align: top;">ESnet-developer</td>
      <td style="vertical-align: top;">group</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">3<br>
      </td>
      <td style="vertical-align: top;">ESnet-user</td>
      <td style="vertical-align: top;">group</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">4<br>
      </td>
      <td style="vertical-align: top;">ESnet-administrator</td>
      <td style="vertical-align: top;">group</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">5<br>
      </td>
      <td style="vertical-align: top;"> ESnet-service</td>
      <td style="vertical-align: top;">group</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">6<br>
      </td>
      <td style="vertical-align: top;">HOPI-developer</td>
      <td style="vertical-align: top;">group</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">7<br>
      </td>
      <td style="vertical-align: top;">user-bob</td>
      <td style="vertical-align: top;">user</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">8<br>
      </td>
      <td style="vertical-align: top;"> user-alice</td>
      <td style="vertical-align: top;">user<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">9<br>
      </td>
      <td style="vertical-align: top;">user-david<br>
      </td>
      <td style="vertical-align: top;">user<br>
      </td>
    </tr>
  </tbody>
</table>
<h3>userAttributes table</h3>
<table style="text-align: left; width: 616px; height: 292px;" border="1"
 cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td style="vertical-align: top;">id (int)&nbsp; </td>
      <td style="vertical-align: top;">loginId (int) </td>
      <td style="vertical-align: top;">attribute id (int) </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">1<br>
      </td>
      <td style="vertical-align: top;">&lt;ed&gt; </td>
      <td style="vertical-align: top;"> &lt;ESnet-eng&gt;</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">11<br>
      </td>
      <td style="vertical-align: top;">&lt;david&gt; </td>
      <td style="vertical-align: top;">&lt;user-david&gt; </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">8<br>
      </td>
      <td style="vertical-align: top;">&lt;david&gt; </td>
      <td style="vertical-align: top;">&lt;ESnet-admin&gt; </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">9<br>
      </td>
      <td style="vertical-align: top;">&lt;david&gt; </td>
      <td style="vertical-align: top;">&lt;ESnet-dev&gt; </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">3<br>
      </td>
      <td style="vertical-align: top;">&lt;chin&gt; </td>
      <td style="vertical-align: top;">&lt;ESnet-eng&gt;</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">4<br>
      </td>
      <td style="vertical-align: top;">&lt;chin&gt;</td>
      <td style="vertical-align: top;">&lt;ESnet-user&gt; </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">5<br>
      </td>
      <td style="vertical-align: top;">&lt;chin&gt;</td>
      <td style="vertical-align: top;">&lt;ESnet-dev&gt; </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">6<br>
      </td>
      <td style="vertical-align: top;">&lt;andy&gt;&nbsp; </td>
      <td style="vertical-align: top;">&lt;HOPI-dev&gt; </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">7<br>
      </td>
      <td style="vertical-align: top;">&lt;andy&gt;</td>
      <td style="vertical-align: top;">&lt;ESnet-user&gt;</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">13<br>
      </td>
      <td style="vertical-align: top;">&lt;alice&gt;<br>
      </td>
      <td style="vertical-align: top;">&lt;user-alice&gt;<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">14<br>
      </td>
      <td style="vertical-align: top;">&lt;bob&gt;<br>
      </td>
      <td style="vertical-align: top;">&lt;user-bob&gt;<br>
      </td>
    </tr>
  </tbody>
</table>
<h3>Authorization Table</h3>
<br>
<table style="text-align: left; width: 616px; height: 892px;" border="1"
 cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td style="vertical-align: top;">id <br>
(int)<br>
      </td>
      <td style="vertical-align: top;">attributeId<br>
(int)<br>
      <br>
      </td>
      <td style="vertical-align: top;">resource<br>
      </td>
      <td style="vertical-align: top;">permission<br>
      </td>
      <td style="vertical-align: top;">constraint name<br>
(string)<br>
      </td>
      <td style="vertical-align: top;">value (int)<br>
1=true, 0=false<br>
      <br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;user-alice&gt;<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">users<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">list<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null
[1]<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;user-alice&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">users</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">query<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null
[1]<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;user-alice&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">users</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">modify<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null
[1]<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;user-alice&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">create<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">max-bandwidth<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">10M<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;user-alice&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">create<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">max-duration<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">600min<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;user-alice&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">list<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">all-users<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;user-alice&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">query<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">all-users<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;user-alice&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">modify<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">all-users<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;user-alice&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">modify</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">max-bandwidth
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">10M<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;user-alice&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">modify
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">max-duration
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">600min<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;user-bob&gt;<br>
      </td>
      <td style="vertical-align: top;">users<br>
      </td>
      <td style="vertical-align: top;">list<br>
      </td>
      <td style="vertical-align: top;">all-users<br>
      </td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;user-bob&gt;</td>
      <td style="vertical-align: top;">users</td>
      <td style="vertical-align: top;">query<br>
      </td>
      <td style="vertical-align: top;">all-users<br>
      </td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;user-bob&gt;</td>
      <td style="vertical-align: top;">users</td>
      <td style="vertical-align: top;">modify<br>
      </td>
      <td style="vertical-align: top;">all-users<br>
      </td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;user-bob&gt;</td>
      <td style="vertical-align: top;">reservations<br>
      </td>
      <td style="vertical-align: top;">create<br>
      </td>
      <td style="vertical-align: top;">specify-path-elements<br>
      </td>
      <td style="vertical-align: top;">0<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;user-bob&gt;</td>
      <td style="vertical-align: top;">reservations</td>
      <td style="vertical-align: top;">list<br>
      </td>
      <td style="vertical-align: top;">all-users<br>
      </td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;user-bob&gt;</td>
      <td style="vertical-align: top;">reservations</td>
      <td style="vertical-align: top;">query<br>
      </td>
      <td style="vertical-align: top;">all-users<br>
      </td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;user-bob&gt;</td>
      <td style="vertical-align: top;">reservations</td>
      <td style="vertical-align: top;">modify<br>
      </td>
      <td style="vertical-align: top;">all-users<br>
      </td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;user-bob&gt;</td>
      <td style="vertical-align: top;">reservations</td>
      <td style="vertical-align: top;">modify<br>
      </td>
      <td style="vertical-align: top;">specify-path-elements </td>
      <td style="vertical-align: top;">0<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-eng&gt;<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">users<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">list<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null&nbsp;
[2]</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-eng&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">users</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">query<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null&nbsp;
[2]<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null</td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-eng&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">users</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">modify<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null&nbsp;
[2]<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null</td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-eng&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">list<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">all-users<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">1<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-eng&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">query<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">all-users<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">1<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-eng&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">create<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">specify-path-elements<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">1<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-eng&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">modify<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">all-users<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">0<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-dev&gt;<br>
      </td>
      <td style="vertical-align: top;">users<br>
      </td>
      <td style="vertical-align: top;">list<br>
      </td>
      <td style="vertical-align: top;">all-users<br>
      </td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-dev&gt;<br>
      </td>
      <td style="vertical-align: top;">users</td>
      <td style="vertical-align: top;">query<br>
      </td>
      <td style="vertical-align: top;">all-users</td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-dev&gt;</td>
      <td style="vertical-align: top;">users</td>
      <td style="vertical-align: top;">modify<br>
      </td>
      <td style="vertical-align: top;">all-users</td>
      <td style="vertical-align: top;">0<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-dev&gt;</td>
      <td style="vertical-align: top;">reservations<br>
      </td>
      <td style="vertical-align: top;">list<br>
      </td>
      <td style="vertical-align: top;">all-users</td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-dev&gt;</td>
      <td style="vertical-align: top;">reservations</td>
      <td style="vertical-align: top;">query<br>
      </td>
      <td style="vertical-align: top;">all-users</td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-dev&gt;</td>
      <td style="vertical-align: top;">reservations</td>
      <td style="vertical-align: top;">create<br>
      </td>
      <td style="vertical-align: top;">max-bandwidth<br>
      </td>
      <td style="vertical-align: top;">10M<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-dev&gt;</td>
      <td style="vertical-align: top;">reservations</td>
      <td style="vertical-align: top;">create<br>
      </td>
      <td style="vertical-align: top;">max-duration<br>
      </td>
      <td style="vertical-align: top;">10min<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-dev&gt;</td>
      <td style="vertical-align: top;">reservations</td>
      <td style="vertical-align: top;">modify<br>
      </td>
      <td style="vertical-align: top;">all-users<br>
      </td>
      <td style="vertical-align: top;">0<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-dev&gt;</td>
      <td style="vertical-align: top;">reservations</td>
      <td style="vertical-align: top;">modify</td>
      <td style="vertical-align: top;">max-bandwidth</td>
      <td style="vertical-align: top;">10M<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-dev&gt;</td>
      <td style="vertical-align: top;">reservations</td>
      <td style="vertical-align: top;">modify</td>
      <td style="vertical-align: top;">max-duration</td>
      <td style="vertical-align: top;">10min<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-user&gt;<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">users<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">list<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null
[2]<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-user&gt;<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">users</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">query<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null
[2]</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-user&gt;<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">users</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">modify<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null
[2]</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-user&gt;<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">list<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null&nbsp;
[3]<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-user&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">query<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null&nbsp;
[3]</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-user&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">create<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null&nbsp;
[3]</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;ESnet-user&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">eservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">modify<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">null&nbsp;
[3]</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-admin&gt;<br>
      </td>
      <td style="vertical-align: top;">users<br>
      </td>
      <td style="vertical-align: top;">list<br>
      </td>
      <td style="vertical-align: top;">all-users<br>
      </td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-admin&gt;</td>
      <td style="vertical-align: top;">users</td>
      <td style="vertical-align: top;">query<br>
      </td>
      <td style="vertical-align: top;">all-users</td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-admin&gt;</td>
      <td style="vertical-align: top;">users</td>
      <td style="vertical-align: top;">modify<br>
      </td>
      <td style="vertical-align: top;">all-users</td>
      <td style="vertical-align: top;">1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">&lt;ESnet-admin&gt;</td>
      <td style="vertical-align: top;">users<br>
      </td>
      <td style="vertical-align: top;">create<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);"><br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;user-david&gt;<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">create<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">specify-path-elements<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">1<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
Defaults<br>
[1] same as all-users=0, selfOnly<br>
[2] manage and view only his own user info<br>
[3] unlimited bandwidth and duration, only modify, list and query own
reservations, not input path components.<br>
<br>
Alice is the least privileged. She is allowed to make reservations of a
limited bandwidth and duration, and only see and modify her own
information. Bob is the leader of a group making reservations. He is
allowed to make reservations of unlimited bandwidth, unlimited
duration, specify ingress, egress and hops and see and manage other
users and their reservations. Ed is a network engineer. As an
ESnet-engineer he can make reservations for the purpose of testing, can
see but not modify other's reservations, can only see user information,
and has free rein over the topology.&nbsp; An ESnet developer can make
reservations of limited bandwidth and durations, view everybody's
reservations but only modify his own, and can see and modify all user
information. An ESnet user can make reservations of unlimited bandwidth
and duration, but only view his own reservations and user information.
An ESnet admin can manage all user information, but not see or modify
reservations. &lt;user-david&gt; has all the permissions of an ESnet
developer and ESnet admin and can also specify path elements when
creating a reservation.<br>
<br>
<h3>CheckAccess Implementation</h3>
The preferred way to implement access control is to isolate the access
checking in one place, called the PolicyDecisionPoint that returns a
permit or deny&nbsp; response and is called by all access control
points (aka Policy Enforcement Points/ PEP) to see if an action is
authorized. The AAA/UserManager class provides two&nbsp; methods for
access checking. The first would be called anyplace where a reservation
is not being modified and the second by createReservation and
modifyReservation.<br>
<br style="font-weight: bold;">
<span style="font-weight: bold;">Standard checkAccess method:<br>
<br>
</span>
<code style="font-weight: bold;"><big>AuthValue
UserManager.checkAccess(String user, String resource, String
permission);</big></code>
<p>Initialize the return value to DENIED<br>
Lookup user in userAttribute table to get list of all attributes<br>
For each attribute lookup ((attrId,resource,permission) in
authorization table.<br>
&nbsp;&nbsp;&nbsp; If deny is returned, continue<br>
&nbsp;&nbsp;&nbsp; If there is no constraint, set returnValue to
SELFONLY and continue<br>
&nbsp;&nbsp;&nbsp; If all-users=true is returned, return ALLUSERS<br>
&nbsp;&nbsp;&nbsp; If all-users=false is returned, set returnValue to
SELFONLY and continue<br>
At end of loop return SELFONLY or DENIED <br>
</p>
<p><span style="font-weight: bold;">checkAccess method called by
createReservation and
modifyReservation:<br>
<br>
</span><big><code style="font-weight: bold;">AuthValue
UserManager.checkModResAccess(String user,String resource,
String permission, int ReqBandWidth, int ReqDuration, Boolean
specify-path-elements);</code></big><br>
<br>
Start out with<br>
&nbsp;&nbsp;&nbsp; ReturnValue = DENIED<br>
&nbsp;&nbsp;&nbsp; bandwidthOK = false<br>
&nbsp;&nbsp;&nbsp; maxdurationOK = false<br>
&nbsp;&nbsp;&nbsp; specPathElemOK = false.<br>
Lookup user in userAttributes table and get a list of attributes for
this user.<br>
For each attribute lookup and
Authrorization(AttrId,resource,permission) <br>
&nbsp;&nbsp; for the authorization returned<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if the constraint is
null <br>
mark bandwidthOK=true and durationOK=true, <br>
and returnValue=SELFONLY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if the constraint is max-bandwidth
<br>
mark bandwidthOK= true if&nbsp; reqBandwidth &lt; constraintValue<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if constraint is max-duration<br>
&nbsp;&nbsp;&nbsp; mark durationOK if reqDuration &lt; constraintValue<br>
&nbsp;&nbsp;&nbsp;&nbsp; if constraint is spec-path-element<br>
&nbsp;&nbsp;&nbsp;&nbsp; mark specPathElemOK = true<br>
&nbsp;&nbsp;&nbsp;&nbsp; if constraint is all-users<br>
&nbsp;&nbsp;&nbsp;&nbsp; if value = 1 set returnValue = ALLUSERS<br>
&nbsp;&nbsp;&nbsp; if value = 0 set returnValue = SELFONLY<br>
At the end of the attribute list<br>
&nbsp;&nbsp; if bandwidthOK = false or maxdurationOK = false<br>
&nbsp;&nbsp;&nbsp; return DENIED<br>
if specify-path-element= true and specPathElemsOK = false<br>
&nbsp;&nbsp;&nbsp; return DENIED<br>
otherwise return ReturnValue<br>
<br>
<br>
<br>
<br>
<br>
</p>
</body>
</html>
