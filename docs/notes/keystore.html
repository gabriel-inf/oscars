<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>Keystore and configuration notes</title>
</head>
<body>
<h1>Keystore and configuration notes</h1>
<h2>The files</h2>
<dl>
   <li><b>axis2.xml</b> on the client-side defines the security.properties file (sec-client.properties) the user
      who will sign the message and specfies that outFlow messages are to be signed
      and timestamped, and that inflow messages are to be timestamped.
   <li><b>services.xml</b> (part of aar) references the security.properties file to use on
     the server side. (sec-server.properties) Specifies that inFlow messages are signed
     and timestamped and outFlow messages are timestamped.
   <li><b>sec-{client/server}.properties </b> has name and password of the keystore to use.
   <li><b>sec-{client/server}.jks</b> has a key entry for the user  and trusted cert entries for any 
       trusted CAs.
   <li><b>ssl-keystore.jks</b>- used when establishing the ssl connection with the tomcat container.
</dl>
<h2>Client side</h2>
   Needs an axis2.xml file to generate signed messages.
   <p>
   Needs  sec-client.properties to define the keystore file and password.
   <p>
   Needs sec-client.jks with the keyEntry for the user who will be signing messages.
       For the user this should be a file with just the trustedCertEntries to
       which the user adds his key/cert. see <a href="exampleClients.html">exampleClients.html</a> for instructions on
       how to do this.
       <p>
   Needs ssl-keystore.jks to hold the trustedCert enties for the ssl connection the server.
   <i>The name and the password for this file are hard-coded into net.es.oscars.client.security.
        KeyManagement.</i>
   <p>
   The default ant task in examples/javaClients/build.xml will create and populate a repo directory 
   with all these pieces. The user may want to edit the axis2.xml to chose a different user to sign the messaage
   and may want to add additional keyEntries to sec-client.jks. Any edited files should be copied to conf/private/client
   since the repo directory is purged and recreated each time ant is run.


<h2>Server side</h2>
  OSCARS needs the properties and keystore referenced in OSCARS.aar:META-INF/services.xml.<br>
  Services.xml comes from conf/public/server/services.xml. The properties and 
  keystore files are installed at the top level OSCARS.aar and come from conf/public/server.
  The keystore only needs trustedCertEntires since response messages are
     not signed.
<p>
  Tomcat needs the keystore referenced in ${catalina.home}/conf/server.xml to do server-side ssl. <br>
  If no keystoreFile entry is specified in the https connnector  element of server.xml, the file ~/.keystore is used.<br>
  If no keystorePass entry is specified the password is "changeit".<br>
  On oscars-dev this is /root/.keystore. The keystore should contains a keyEntry for the oscars-dev 
  cert/key  with alias tomcat and the trustedcert entries for that key.
  
  <h2>Server acting as client, e.g when forwarding request to next Domain</h2>
   Needs trustedCertEnties and oscars-dev keyEntry, (not distributed outside
   of LBL in conf/private/sec-client.jks). The ant task setupServer will create a repo directory
   with the necessary axis2.xml, sec-client.properties and sec-client.jks in ${catalina.home}/shared/oscars.conf/axis2-repo
   directory.
  
</body>
</html>	
