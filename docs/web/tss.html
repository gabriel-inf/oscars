<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>TSS component notes</title>
  <base href="/docs">
  <link rel="stylesheet" href="styleSheets/oscars.css" type="text/css">
  <link rel="shortcut icon" href="images/esnet.ico" type="image/x-icon">
</head>
<body>
<!--#include virtual="header.html" -->
<div id="topBar" class="topBar">
<div class="topBarDiv"> &nbsp; <a href="index.html">home</a> &gt;
Components &gt; <a href="tss.html">Topology Exchange</a>
</div>
</div>
<h1>TSS component notes</h1>
<h2>Overview</h2>
<p>The TSS component deals with network topology database exchange
between interdomain controllers (<i>IDC</i>). IDCs need to exchange
topology
information to facilitate interdomain pathfinding. The TSS subsystem
is responsible for passing out local topology information, and for
importing topology information from other IDCs. OSCARS uses the Open
Grid&nbsp; Forum Network Measurements Working Group (NMWG) control
plane <a
 href="https://damsl.cis.udel.edu/svn/proto_docs/Topo_Schema/schema/nmtopo_ctrlplane.rnc">XML
schema&nbsp;</a> developed by DICE to describe topology that is being
exchanged. <br>
</p>
<p> Currently OSCARS supports these operations on two different
implementations of the topology database:</p>
<ul>
  <li>Local SQL/Hibernate topology DB</li>
  <li>Remote topology web service (TERCE)</li>
</ul>
<p>The OSCARS administrator can choose which method of topology
exchange database (<i>TEDB</i>) they want to use at configuration time.</p>
<p>Moreover, OSCARS developers with different needs may develop their
own TEDB implementation by creating a new class that implements the
TEDB java interface.</p>
<h2>Configuration</h2>
<p>The admin must choose which TEDB method they want to run by
configuring the OSCARS server through oscars.properties. The relevant
property is tedb.tedbMethod. Valid values are:</p>
<ul>
  <li><b>terce</b> for the interface to TERCE</li>
  <li><b>oscars</b> for the local Hibernate DB</li>
</ul>
<p>In both those cases the administrator must initialize the topology
database accordingly. </p>
<h2>Development</h2>
<p>To develop a new TEDB method, the developer should implement the
net.es.oscars.tss.TEDB interface. Then a short name for the method must
be chosen (in addition to "oscars" and "terce"), and TEDBFactory must
be modified to load the appropriate class when the tedb.tedbMethod
property has that value.<br>
</p>
<h2>BSS Topology Tables</h2>
The topology tables are used by the OSCARS and interdomain pathfinder
when finding a route. They are also used by the scheduling code to
check for oversubscription and elements from them are referenced from
the reservation tables. Thus, even at a site where the local topology
and pathfinding are provided by an exernal service such as TERCE these
tables are required. At Dragon sites, topoloy is imported from TERCE
and stored in the topology tables.<br>
<br>
OSCARS assumes that you have described your topology in the Open Grid
Forum (OGF) Network Measurement Working Group (NMWG) <a
 name="nmwgTopologySchema"></a>control plane
topology schema. The NMWG topology schema consists of a hierarchy of <span
 style="font-weight: bold;">domains, nodes, ports,</span> and <span
 style="font-weight: bold;">links</span>. The table below describes
each of these elements<br>
<br>
<table
 style="margin-left: auto; margin-right: auto; text-align: left; width: 572px; height: 247px;"
 border="1" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <th style="vertical-align: top; width: 70px;">Element<br>
      </th>
      <th style="vertical-align: top; width: 120px;">Child Element<br>
      </th>
      <th style="vertical-align: top;">Description<br>
      </th>
    </tr>
    <tr>
      <td style="vertical-align: top; width: 70px;">domain<br>
      </td>
      <td style="vertical-align: top; width: 120px;">node<br>
      </td>
      <td style="vertical-align: top;">Represents an
administratively-similar set of devices<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; width: 70px;">node<br>
      </td>
      <td style="vertical-align: top; width: 120px;">port<br>
      </td>
      <td style="vertical-align: top;">Represents a network device. For
this installation, it represents a VLSR<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; width: 70px;">port<br>
      </td>
      <td style="vertical-align: top; width: 120px;">link<br>
      </td>
      <td style="vertical-align: top;">Represent a physical or virtual
port on the network. Corresponds to a physical port number and/or
DRAGON local-id for this installation.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; width: 70px;">link<br>
      </td>
      <td style="vertical-align: top; width: 120px;"><br>
      </td>
      <td style="vertical-align: top;">Represents a connection between
two ports. For the purposes of this installation, you will likely have
one port per link.<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
The topology identifiers that are used are Uniform Resource Names (URN)
that contain not only an ID for the element defining it, but also its
parent elements. This type of identifier is referred to as a
fully-qualified identifier. These IDs always begin with the prefix
&#8220;urn:ogf:network:&#8221;. This prefix is followed by a colon-delimited list
of identifiers appropriate for that hierarchical level. For example, a
fully-qualified port ID contains a domain ID, a node ID, and the port
ID. The hierarchical level of each portion is indicated by either a
&#8220;domain=&#8221;,&#8221;node=&#8221;, &#8220;port=&#8221;, or &#8220;link=&#8221; prefix.Examples of different
fully-qualified link ID types from the example I2 topology files that
come with the software are shown below:<br>
<br>
<table
 style="margin-left: auto; margin-right: auto; text-align: left; width: 639px; height: 138px;"
 border="1" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <th style="vertical-align: top;">Type<br>
      </th>
      <th style="vertical-align: top;">Fully-Qualified Identifier<br>
      </th>
    </tr>
    <tr>
      <td style="vertical-align: top;">domain ID<br>
      </td>
      <td style="vertical-align: top;">urn:ogf:network:domain=blue.pod.lan<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">node ID<br>
      </td>
      <td style="vertical-align: top;">urn:ogf:network:domain=blue.pod.lan:node=vlsr1<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">port ID<br>
      </td>
      <td style="vertical-align: top;">urn:ogf:network:domain=blue.pod.lan:node=vlsr1:port=3<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">link ID<br>
      </td>
      <td style="vertical-align: top;">urn:ogf:network:domain=blue.pod.lan:node=vlsr1:port=3:link=11.2.1.2<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<p>
The <span style="font-weight: bold;">domains table</span> contains the
following information about each domain that the IDC can interact with:<br>
</p>
<pre> 	Integer id              /** identifier field */  <br>	String topologyIdent 	/** persistant field */ <br>	String name          	/** persistant field */	<br>	String url           	/** persistant field: of OSCARS service for the domain */<br>	String abbrev        	/** persistant field */ <br>	boolean local         	/** persistant field: is this the local domain */</pre>
<p>The <span style="font-weight: bold;">nodes table</span> contains
the following information about each node:
</p>
<pre>	Integer id        	/** identifier field */ <br>	boolean valid         	/** persistant field */ <br>	String topologyIdent 	/** persistant field */ <br>	Integer domainId      	/** persistant field: parent domain */</pre>
<p>The <span style="font-weight: bold;">ports table</span> contains
the following information for each port
</p>
<pre>	Integer id                      /** identifier field */ 	<br>	boolean valid                   /** persistant field */  <br>	Integer snmpIndex               /** persistant field */  <br>	String topologyIdent            /** persistant field */  <br>	Long capacity                  	/** persistant field */  <br>	Long maximumReservableCapacity 	/** persistant field */  <br>	Long minimumReservableCapacity 	/** persistant field */<br>&nbsp;	Long unreservedCapacity        	/** persistant field */   <br>	String alias                   	/** nullable persistent field */ <br>	Integer nodeId                 	/** persistant field: parent node */</pre>
<p>snmpIndex seems to always be set to 1 and not used.</p>
<p>The <span style="font-weight: bold;">links table</span> contains
the following information for each link in
the local
domain:
</p>
<pre>	Integer id 			/** identifier field */ <br>	boolean valid                   /** persistant field */  <br>	Integer snmpIndex               /** nullable persistent field */ <br>	String topologyIdent            /** persistant field */ <br>	String trafficEngineeringMetric /** nullable persistent field */ <br>	Long capacity                  	/** nullable persistent field */ <br>	Long maximumReservableCapacity 	/** nullable persistent field */<br>	Long minimumReservableCapacity 	/** nullable persistent field */ <br>	Long granularity               	/** nullable persistent field */  <br>	Long unreservedCapacity        	/** nullable persistent field */  <br>	String alias                    /** nullable persistent field */ <br>	Integer remoteLinkId            /** nullable persistent field */ <br>	Integer portId                 	/** persistant field: parent port */<br>	Set ipaddrs			/** optional set of ippaddrs */<br>	Integer l2SwitchingCapabilityData /** optional index into the l2SwitchingCapabilityData table */ <br></pre>
Where the topologyIdent is a logical name that identifies the link;
trafficEngineeringMetric is a description of a traffic metric that may
be used
when selecting a path: granularity is the increments at which the
bandwidth may
be reserved; remoteLinkId is an index into the links table for the link
on the other end of the
connection; and portId is an index into the ports table for the parent
port. If the&nbsp;
capacity fields are null, the information is taken from the parent
port. <span style="font-weight: bold;"></span><br>
<br>
The <span style="font-weight: bold;">ipaddrs table</span> contains the
following information:<br>
<pre>	Integer id              /** identifier field */ <br>	boolean valid  		/** persistant field */ <br>	String IP     		/** persistant field */ <br>	Integer linkId 		/** persistant field, index into links table */<br><br>Used to get a  valid IP Address for a link.<br></pre>
<span style="font-weight: bold;">nodeAddresses table</span> - does not
appear to be currently used.<br>
<pre>	Integer id      	/** identifier field */  <br>	String address 		/** persistant field: dotted IP address */ <br>	Integer nodeId  	/** persistant field: corresponding entry in nodes table */</pre>
<span style="font-weight: bold;">
edgeInfos table</span><span style="font-weight: bold;"><br>
</span>
<pre>	Integer id      	/** identifier field */  <br>	String externalIP	/** persistant field */<br>	Integer ipaddrId	/** persistant field, index into ipaddrs table */ <br>	Integer domainId	/** persistant field, index into domains table */</pre>
The next domain on an input layer2 path is found by looking up the
first hop outside of this domain, the externalIP, in this table.<br>
<br>
<span style="font-weight: bold;">interdomainRoutes table</span><br>
<pre>	Integer id      	/** identifier field */  	<br>	Integer srcNodeId    	/** nullable persistent field */<br>	Integer srcPortId	/** nullable persistent field */ <br>	Integer srcLinkId	/** nullable persistent field */ <br>	Integer destDomainId	/** nullable persistent field */ <br>	Integer destNodeId	/** nullable persistent field */ <br> 	Integer destLinkId	/** nullable persistent field */ <br>	Integer routeElemId	/** persistant field */  <br>	Integer preference	/** persistant field */  <br>	boolean defaultRoute	/** persistant field */      </pre>
Used to look-up routes that match the given source and destination,
specified by either nodes, ports or links. If no routes match then the
default route or null is returned. It orders routes by source,
destination and preference. Matches that are more specific are ordered
higher (i.e. a matching link is higher than a matching port, etc). Used
by the genericInterdomainPathfinder.<br>
<br>
<span style="font-weight: bold;">routeElems table</span><br>
<pre>	Integer id      	/** identifier field */ <br>	Integer domainId 	/** nullable persistent field */<br>	Integer nodeId		/** nullable persistent field */ <br>	Integer portId		/** nullable persistent field */ <br>	Integer linkId		/** nullable persistent field */ <br>	Integer nextHopId	/** nullable persistent field */ <br>	String description	/** nullable persistent field */<br>	<br>Contains the indexes into the domain,node,port and link table for an interdomainRoute.<br>nextHopId is an index into this table for then next hop on the route.<br><br><span
 style="font-weight: bold;">l2SwitchingCapabilityData table</span><br
 style="font-weight: bold;"><br>	Integer id      	/** identifier field */ <br>	Integer linkId		/** persistent field */ <br>	String vlanRangeAvailability	/** persistent field */ | <br>	Integer interfaceMTU	/** persistent field */ <br><br>Will find switching capability for a given link. <br><span
 style="font-weight: bold;"></span><br></pre>
<br>
<!--#include virtual="footer.html" -->
</body>
</html>
