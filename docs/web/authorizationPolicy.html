<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>Authorization Policy</title>
  <link rel="stylesheet" href="styleSheets/oscars.css" type="text/css">
  <link rel="shortcut icon" href="images/esnet.ico" type="image/x-icon">
</head>
<body>
<br>
<br>
<!--#include virtual="header.html" -->
<div id="topBar" class="topBar">
<div class="topBarDiv"> &nbsp; <a href="index.html">home</a> &gt; <a
 href="authorizationPolicy.html">Authorization Policy</a>
</div>
</div>
<h1>OSCARS Authorization Policy</h1>
<br>
<ol id="mozToc">
<!--mozToc h2 1 h3 2 h4 3 h4 4 h5 5 h6 6--><li><a href="#mozTocId6115">Introduction</a></li>
  <li><a href="#mozTocId788215">Authorization policy requirements </a>
    <ol>
      <li><a href="#mozTocId189841">Permissions with respect to users
and institutions </a></li>
      <li><a href="#mozTocId884752">Permissions with respect to
bandwidth and reservations</a></li>
      <li><a href="#mozTocId897657">Permissions with respect to
topology </a></li>
      <li><a href="#mozTocId863497">Permission with respect to
authorizations</a></li>
      <li><a href="#mozTocId381061">Permission with respect to
notification server</a></li>
    </ol>
  </li>
  <li><a href="#mozTocId328735">Policy Tables</a>
    <ol>
      <li><a href="#mozTocId53543">Table summary</a></li>
      <li><a href="#mozTocId730373">Default behaviors</a></li>
    </ol>
  </li>
  <li><a href="#mozTocId834880">Mapping of requirements to
authorizations</a>
    <ol>
      <li><a href="#mozTocId735363">Permissions with respect to users
and institutions </a></li>
      <li><a href="#mozTocId677595">Permissions with respect to
bandwidth and reservations</a></li>
      <li><a href="#mozTocId42461">Permissions with respect to topology
        </a></li>
      <li><a href="#mozTocId89020">Permission with respect to
authorizations</a></li>
      <li><a href="#mozTocId322242">Permission with respect to
notification server</a></li>
    </ol>
  </li>
  <li><a href="#mozTocId592874">Default Tables </a>
    <ol>
      <li><a href="#mozTocId174937">Attributes Table</a></li>
      <li><a href="#mozTocId170830">Default Authorizations Table</a></li>
    </ol>
  </li>
  <li><a href="#mozTocId625591">API for access checks</a>
    <ol>
      <li><a href="#mozTocId804096">CheckAccess Implementation</a></li>
      <li><a href="#mozTocId305904">Standard method</a></li>
      <li><a href="#mozTocId364346">Method for
create and modify reservations</a></li>
    </ol>
  </li>
</ol>
<h2><a class="mozTocH2" name="mozTocId6115"></a>Introduction</h2>
An authorization decision consists of deciding if an authenticated
entity should be allowed to perform some action on a controlled
resource. In OSCARS an authenticated entity may be a bandwidth user or
a bandwidth reservation service from another domain; the fundamental
resource is bandwidth though the domain, and the fundamental permission
is right to reserve some fraction of the available bandwidth. Since
available bandwidth is a limited resource, some finer control is needed
such as the maximum allowed bandwidth and duration. In addition, some
users of the system needed to request or suggest possible internal
routing for the data path.
<p>OSCARS chose to do attribute-based authorization primarily as a way
of
consolidating authorization policy to make it more understandable to
users and OSCARS administrators and partly in anticipation of
integrating with an external attribute provider such as Shibboleth or
VOMS. An attribute is some characteristic of a user, such as being a
member of some project, a holder of some role, or just his identity as
expressed as a registered user name or x.509 identity certificate. A
user gets the maximum of all the privileges granted to all of the
attributes that he has. </p>
<p>OSCARS is currently a self-contained system that defines who its
registered users are and what attributes each one has. As a result, it
needs to control who may manage users and their permissions, so users
become a controlled resource in addition to bandwidth. Another resource
is the internal topology, since we want control who may view the or
reload the topology tables that are used in pathfinding. In addition,
there is a notification service running as part of OSCARS, and the
right to publish events there or subscribe to events is controlled.<br>
</p>
<p>The underlying guideline of our design and implementation is to keep
authorization policy and implementation as simple as possible. We have
tried to make the granularity of access decisions no finer than is
actually required, and have defined roles to consolidate sets of
authorizations into roles that will accommodate the use cases we
anticipate. Some of our
underlying assumptions are: Most users will get their permissions by
being members of a role, rather than by individual grants. The
number of roles will be small. The number of resources and
permissions will be small. While the implementation may scale to larger
numbers, the ability of the users and administrators to understand it
will not.
</p>
<p>We are currently intending to authorize a reservation that has been
forwarded to ESnet from an adjacent domain based on the attributes
assigned to that domain rather than the end user who is requesting the
reservation. Thus the number of users that must be registered with the
system can remain manageable. The name of the user is included in the
forwarded request, so it can be used for auditing purposes or can later
be used for authorization. <br>
</p>
<h2><a class="mozTocH2" name="mozTocId788215"></a>Authorization policy
requirements<br>
</h2>
The following paragraphs list the various actions that we want to
control with respect to the resources that OSCARS controls.<br>
<h3><a class="mozTocH3" name="mozTocId189841"></a>Permissions with
respect to users and institutions<br>
</h3>
<ul>
  <li>see own profile</li>
  <li>modify own profile</li>
  <li>list all users</li>
  <li>see all user profiles</li>
  <li>add/delete a user</li>
  <li>modify any user profile</li>
  <li>grant or remove attributes for any user</li>
  <li>add, edit or delete institutions<br>
  </li>
</ul>
<h3><a class="mozTocH3" name="mozTocId884752"></a>Permissions with
respect to bandwidth and reservations</h3>
<ul>
  <li>make unlimited reservation</li>
  <li>make reservation with bandwidth constraint</li>
  <li>make reservation with duration constraint</li>
  <li>make reservation with topology constraint</li>
  <li>list own reservations</li>
  <li>query own reservations</li>
  <li>cancel, modify own reservations</li>
  <li>signal own reservations</li>
  <li>list all reservations starting or terminating at a site<br>
  </li>
  <li>query any reservations starting or terminating at a site</li>
  <li>cancel, modify any reservations starting or terminating at a site
  </li>
  <li>list all reservations</li>
  <li>query any reservations</li>
  <li>cancel, modify any reservations</li>
  <li>signal any reservations</li>
  <li>cancel, modify and signal any reservations regardless of state<br>
  </li>
</ul>
<span style="font-style: italic;">(signaling instantiates a reservation
or tears down an established circuit by causing the appropriate
commands to be sent to the routers involved)</span><br>
<h3><a class="mozTocH3" name="mozTocId897657"></a>Permissions with
respect to topology <br>
</h3>
<ul>
  <li>view topology</li>
  <li>modify the topology</li>
</ul>
<h3><a class="mozTocH3" name="mozTocId863497"></a>Permission with
respect to authorizations</h3>
<ul>
  <li>view all attributes and authorizations</li>
  <li>create, modify or delete attributes<br>
  </li>
  <li>modify authorizations associated with attributes<br>
  </li>
</ul>
<h3><a class="mozTocH3" name="mozTocId381061"></a>Permission with
respect to notification server</h3>
<ul>
  <li>register to publish events</li>
  <li>remove publisher registrations<br>
  </li>
  <li>subscribe to events</li>
  <li>renew or cancel a subscription<br>
  </li>
</ul>
<h2><a class="mozTocH2" name="mozTocId328735"></a>Policy Tables</h2>
All access decisions are made by one of two methods which are called
from each place in the code that is about to grant some access. Access
policy is stored in a database, and an access decision is made by doing
table lookups based on the requester, the action requested and the
resource. Authorizations may have constraints attached, in which case
the parameters of the request must meet the constraints. <br>
<br>
<h3><a class="mozTocH3" name="mozTocId53543"></a>Table summary</h3>
The following tables define the components for authorization:<br>
<ul>
  <li><span style="font-weight: bold;">users </span>&#8211; contains
an entry for each registered user, containing among other things, user
loginId, institution to which the user belongs, certSubject and
certIssuer</li>
  <li><span style="font-weight: bold;">resources</span> &#8211; constains an
entry
for each resource that needs to be controlled:</li>
  <ul>
    <li><span style="font-weight: bold;">reservations </span>- all
information about reservations </li>
    <li><span style="font-weight: bold;">topology</span> - the
description of the network topology<br>
    </li>
    <li><span style="font-weight: bold;">users </span>- all
information about users<span style="font-weight: bold;"><br>
      </span></li>
    <li><span style="font-weight: bold;">AA </span>- the attributes,
institutions and authorizations</li>
    <li><span style="font-weight: bold;">subscriptions</span> -
receiving notifications of OSCARS events</li>
    <li><span style="font-weight: bold;">publishers</span> - publish
OSCARS events<br>
    </li>
  </ul>
  <li><span style="font-weight: bold;">permissions</span> &#8211; actions
that can be performed on a resource<br>
  </li>
  <ul>
    <li><span style="font-weight: bold;">list</span> &#8211; shows
minimum information about a reservation or
user, shows the authorization tables<br>
    </li>
    <li><span style="font-weight: bold;">query</span> &#8211; shows all
information about a reservation, user or the topology<br>
    </li>
    <li><span style="font-weight: bold;">create</span> &#8211; allows a
new user to added, a reservation to
be
created, a new subscription to be made, or to register as a publisher<br>
    </li>
    <li><span style="font-weight: bold;">modify</span> &#8211; allows
deletion of a user and modification to a
user profile or cancellation or modification of a reservation.&nbsp;
Allows modification of the institutions, attributes and authorizations
tables. Allows reloading of the topology tables. Also allows renewal
and cancellation of subscriptions and deletion of a publisher
registration.<br>
    </li>
    <li><span style="font-weight: bold;">signal </span>&#8211; allows a
circuit for reservation to be instantiated or torn down.<br>
    </li>
  </ul>
  <li><span style="font-weight: bold;"> attributes</span> &#8211; has entries
for attributes on which authorization
is based. The default attributes are:
    <ul>
      <li>OSCARS-user </li>
      <li>OSCARS-engineer </li>
      <li>OSCARS-admin</li>
      <li>OSCARS-service </li>
      <li>OSCARS-operator </li>
      <li>OSCARS-site-administrator </li>
      <li>OSCARS-publisher </li>
    </ul>
  </li>
  <li>There is an
attribute-type field which is set to <span style="font-style: italic;">role</span>
for all these attributes. There is currently one <span
 style="font-style: italic;">privilege</span> attribute:
specify-path-elements, which is intended to be an additional attribute
for some non-privileged users. It
is possible to define explicit user attributes for users with specific
permissions, e.g.
user-david with the attribute type user. So far we have not found
the&nbsp; need for any user attributes. For a more detailed desciption
of the attributes see <a href="attributes.html">here</a>.<br>
  </li>
  <li><span style="font-weight: bold;"> userAttributes</span> -
maps userIds to the attributes they
possess<br>
  </li>
  <li><span style="font-weight: bold;"> constraints</span> - The
current constraints that are supported are: <br>
    <ul>
      <li><span style="font-weight: bold;">none</span>&nbsp;
applies to everything, place holder in tables indicating there is no
constraint<br>
        <span style="font-weight: bold;"></span></li>
      <li><span style="font-weight: bold;">max-bandwidth</span> (int),
applies to create and modify reservation</li>
      <li> <span style="font-weight: bold;">max-duration</span>
(int),
applies to create and modify reservation</li>
      <li> <span style="font-weight: bold;">specify-path-elements </span>(boolean),
applies to create and modify
reservation</li>
      <li><span style="font-weight: bold;">specify-gri</span> (boolean)
can a Global Reservation Identifier be
specified
on create reservation</li>
      <li> <span style="font-weight: bold;">all-users </span>(boolean),
applies to everything except create
reservation.</li>
      <li><span style="font-weight: bold;">my-site</span> (boolean)
currently applies only to list, query, cancel and modify reservations</li>
      <li><span style="font-weight: bold;">unsafe-allowed </span>(boolean)
allows state changes to a reservation regardless of whether it is an
acceptable change. e.g. allows FINISHED-&gt;CANCELLED rather than just
ACTIVE or PENDING -&gt; CANCELLED. Intended for use by a
network engineer trying to correct errors in the OSCARS tables.<br>
      </li>
    </ul>
  </li>
  <li><span style="font-weight: bold;">authorizations</span> - combines
these elements into a row for each
action that each user is permitted. Each row consists of an attribute
id, a resource id, a permission id , a constraint id and value.<br>
  </li>
</ul>
<br>
Users may have one or more attributes although the role attributes,
except for administrator are designed to be used alone.
Attributes and authorizations are arbitrary strings and while there is
a default set defined, it is
expected that sites may re-define or add new ones to meet their
needs.&nbsp; On the other hand, resources, permissions, and constraints
are strings that are used by the code and changing them must be
accompanied by code changes that enforce the semantics desired.<br>
<br>
Using attributes to grant authorizations, rather than just the user
identity, allows a set of authorizations
to be crafted which can then be applied to a class of users. Otherwise,
each time a new user registers, he must be given the correct and
complete set of permissions for whatever he wants to do.
Currently the OSCARS AA system registers users and assigns them
attributes. In the future, user identities and attributes may be
available from multiple external identity or attributes providers.<br>
<br>
<h3><a class="mozTocH3" name="mozTocId730373"></a>Default behaviors</h3>
If a user has no entry in the user table or has no attributes in
the userAttribute table, any attempted OSCARS
access
will be rejected immediately by Oscars:OscarsSkeleton:checkUser or
Servlets:AuthenticateUser<br>
If no attribute that the user possesses has an entry for the
required resource/permission pair in the authorization table, the
request is
denied.<br>
The constraint defaults are intended to be the most common cases,
not
the most restricted.<br>
<ul>
  <li>If there is no max bandwidth constraint specified, there is
no limit
on the bandwidth that may be requested.</li>
  <li>If there is no duration constraint, unlimited duration and
persistent
reservations are allowed.</li>
  <li>If no all-users constraint is specified, the default is
false (only access to own information is allowed).</li>
  <li>If a my-site constraint is specified access to
information that is site specific is allowed.</li>
  <li>If specify-path-elements is not specified, the default is
false and
no routers or hops may be input.</li>
  <li>If an unsafe-allowed constraint is specified any reservation
state change will
be accepted e.g. FINISHED -&gt; ACTIVE. Otherwise only reasonable state
changes will be made, e.g. PENDING or ACTIVE to CANCELLED (cancel
reservation),
ACTIVE to PENDING (signal a teardown), PENDING to ACTIVE (signal a
setup)</li>
  <li>If specify-gri is not specified, a GlobalResourceId may not
be
specified by the user, but will be automatically generated by the
CreateReservation code. This is should be used only by OSCARS-service.<br>
  </li>
</ul>
<ul>
</ul>
<h2><a class="mozTocH2" name="mozTocId834880"></a>Mapping of
requirements to authorizations</h2>
The following tables describe the possible actions
and the authorizations that they require.<br>
<h3><a class="mozTocH3" name="mozTocId735363"></a>Permissions with
respect to users and institutions<br>
</h3>
<table style="width: 668px; height: 251px;" border="1" cellpadding="5"
 cellspacing="0">
  <tbody>
    <tr style="background-color: rgb(255, 255, 204);">
      <td><span style="font-weight: bold;">desired action</span> </td>
      <td><span style="font-weight: bold;">permission resource,
constraint</span> </td>
    </tr>
    <tr>
      <td>see own profile</td>
      <td>query users </td>
    </tr>
    <tr>
      <td>modify own profile</td>
      <td>modify users </td>
    </tr>
    <tr>
      <td>list all users</td>
      <td>list users </td>
    </tr>
    <tr>
      <td>see all user profiles</td>
      <td>query users, all-users </td>
    </tr>
    <tr>
      <td>add a user</td>
      <td>create users, all-users </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">delete a user<br>
      </td>
      <td style="vertical-align: top;">modify users, all-users</td>
    </tr>
    <tr>
      <td>modify any user profile</td>
      <td>modify users, all-users </td>
    </tr>
    <tr>
      <td>grant or remove attributes for any user</td>
      <td>modify users, all-users </td>
    </tr>
    <tr>
      <td>add, edit or delete institutions<br>
      </td>
      <td>modify AAA </td>
    </tr>
  </tbody>
</table>
<br>
<h3><a class="mozTocH3" name="mozTocId677595"></a>Permissions with
respect to bandwidth and reservations</h3>
<table border="1" cellpadding="5" cellspacing="0">
  <tbody>
    <tr style="background-color: rgb(255, 255, 204);">
      <td><span style="font-weight: bold;">desired action</span> </td>
      <td><span style="font-weight: bold;">permission resource,
constraint</span> </td>
    </tr>
    <tr>
      <td>make unlimited reservation</td>
      <td>create reservations </td>
    </tr>
    <tr>
      <td>make reservation with bandwidth constraint</td>
      <td>create reservations, max-bandwidth= &lt;upper-limit&gt;<br>
      </td>
    </tr>
    <tr>
      <td>make reservation with duration constraint</td>
      <td>create reservations, max-duration=&lt;upper-limit&gt;<br>
      </td>
    </tr>
    <tr>
      <td>make reservation with topology constraint</td>
      <td>create reservations, specify-path-elements<br>
      </td>
    </tr>
    <tr>
      <td>list own reservations</td>
      <td>list reservations </td>
    </tr>
    <tr>
      <td>query own reservations</td>
      <td>query reservations </td>
    </tr>
    <tr>
      <td>cancel, modify own reservation</td>
      <td>modify reservations </td>
    </tr>
    <tr>
      <td>signal own reservation</td>
      <td>signal reservations </td>
    </tr>
    <tr>
      <td>list all reservations starting or terminating at a site<br>
      </td>
      <td>list reservations, my-site </td>
    </tr>
    <tr>
      <td>query any reservations starting or terminating at a site</td>
      <td>query reservations, my-site </td>
    </tr>
    <tr>
      <td>cancel, modify any reservations starting or terminating at a
site </td>
      <td>modify reservations, my-site </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">signal any reservations starting
or terminating at a
site</td>
      <td style="vertical-align: top;">signal reservations, my-site</td>
    </tr>
    <tr>
      <td>list all reservations</td>
      <td>list reservations, all-users </td>
    </tr>
    <tr>
      <td>query any reservations</td>
      <td>query reservations, all-users </td>
    </tr>
    <tr>
      <td>cancel, modify any reservations</td>
      <td>modify reservations, all-users </td>
    </tr>
    <tr>
      <td>signal any reservations</td>
      <td>signal reservations, all-users </td>
    </tr>
    <tr>
      <td>cancel, modify and signal any reservations regardless of state<br>
      </td>
      <td>signal reservations, unsafe-allowed </td>
    </tr>
  </tbody>
</table>
<span style="font-style: italic;">(signaling instantiates a reservation
or tears down an established circuit by causing the appropriate
commands to be sent to the routers involved)</span><br>
<br>
<h3><a class="mozTocH3" name="mozTocId42461"></a>Permissions with
respect to topology <br>
</h3>
<table style="width: 668px; height: 84px;" border="1" cellpadding="5"
 cellspacing="0">
  <tbody>
    <tr style="background-color: rgb(255, 255, 204);">
      <td><span style="font-weight: bold;">desired action</span> </td>
      <td><span style="font-weight: bold;">permission resource,
constraint</span> </td>
    </tr>
    <tr>
      <td>view topology</td>
      <td>query domains </td>
    </tr>
    <tr>
      <td>modify the topology</td>
      <td>modify domains </td>
    </tr>
  </tbody>
</table>
<br>
<h3><a class="mozTocH3" name="mozTocId89020"></a>Permission with
respect to authorizations</h3>
<table style="width: 672px; height: 99px;" border="1" cellpadding="5"
 cellspacing="0">
  <tbody>
    <tr style="background-color: rgb(255, 255, 204);">
      <td><span style="font-weight: bold;">desired action</span> </td>
      <td><span style="font-weight: bold;">permission resource,
constraint</span> </td>
    </tr>
    <tr>
      <td>view all attributes and authorizations</td>
      <td>list AAA </td>
    </tr>
    <tr>
      <td>create or delete attributes</td>
      <td>modify AAA </td>
    </tr>
    <tr>
      <td>add/modify authorizations associated with attributes <br>
      </td>
      <td>modify AAA </td>
    </tr>
  </tbody>
</table>
<br>
<h3><a class="mozTocH3" name="mozTocId322242"></a>Permission with
respect to notification server</h3>
<table style="width: 670px; height: 142px;" border="1" cellpadding="5"
 cellspacing="0">
  <tbody>
    <tr style="background-color: rgb(255, 255, 204);">
      <td><span style="font-weight: bold;">desired action</span> </td>
      <td><span style="font-weight: bold;">permission resource,
constraint</span> </td>
    </tr>
    <tr>
      <td>register to publish events</td>
      <td>create publishers </td>
    </tr>
    <tr>
      <td>remove publishers registration </td>
      <td>modify publishers</td>
    </tr>
    <tr>
      <td>subscribe to events</td>
      <td>create subscriptions </td>
    </tr>
    <tr>
      <td>renew or cancel a subscription</td>
      <td>modify subscriptions</td>
    </tr>
  </tbody>
</table>
<br>
<br>
<h2><a class="mozTocH2" name="mozTocId592874"></a>Default Tables<br>
</h2>
The distribution includes scripts (sql/aaa/populateDefaults.sql) to set
up the roles described above. The standard attributes are entered into
the Attributes table.<span style="font-weight: bold;"><br>
</span>
<h3><a class="mozTocH3" name="mozTocId174937"></a>Attributes Table</h3>
<table style="text-align: left; width: 616px; height: 220px;" border="1"
 cellpadding="2" cellspacing="0">
  <tbody>
    <tr style="background-color: rgb(255, 255, 204);">
      <td style="vertical-align: top;"><span style="font-weight: bold;">attribute
name</span> (string) <br>
      </td>
      <td style="vertical-align: top;"><span style="font-weight: bold;">attribute
type</span> (int)</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">OSCARS-user<br>
      </td>
      <td style="vertical-align: top;">role</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">OSCARS-engineer</td>
      <td style="vertical-align: top;">role</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">OSCARS-administrator</td>
      <td style="vertical-align: top;">role</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">OSCARS-service</td>
      <td style="vertical-align: top;">role</td>
    </tr>
    <tr>
      <td style="vertical-align: top;"> OSCARS-operator</td>
      <td style="vertical-align: top;">role<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">OSCARS-site-administrator<br>
      </td>
      <td style="vertical-align: top;">role </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">OSCARS-publisher</td>
      <td style="vertical-align: top;">role</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">OSCARS-may-specify-path<br>
      </td>
      <td style="vertical-align: top;">privilege<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<h3><a class="mozTocH3" name="mozTocId170830"></a><a name="authTable"></a>Default
Authorizations Table</h3>
<table style="" 1="" border="1" cellpadding="5" cellspacing="0">
  <tbody>
    <tr style="background-color: rgb(255, 255, 204);">
      <td><span style="font-weight: bold;">attributeId</span>&nbsp;
(int) </td>
      <td><span style="font-weight: bold;">resource</span> </td>
      <td><span style="font-weight: bold;">permission</span> </td>
      <td><span style="font-weight: bold;">constraint name </span>
(string) </td>
      <td><span style="font-weight: bold;">value</span>
(string)</td>
    </tr>
    <tr>
      <td>&lt;OSCARS-user&gt;</td>
      <td>users</td>
      <td>query</td>
      <td>none [1]</td>
      <td> <br>
      </td>
    </tr>
    <tr>
      <td>&lt;OSCARS-user&gt;</td>
      <td>users</td>
      <td>modify</td>
      <td>none [1]</td>
      <td><br>
      </td>
    </tr>
    <tr>
      <td>&lt;OSCARS-user&gt;</td>
      <td>reservations</td>
      <td>list</td>
      <td>none [2]</td>
      <td> <br>
      </td>
    </tr>
    <tr>
      <td>&lt;OSCARS-user&gt;</td>
      <td>reservations</td>
      <td>query </td>
      <td>none [2]</td>
      <td> <br>
      </td>
    </tr>
    <tr>
      <td>&lt;OSCARS-user&gt;</td>
      <td>reservations</td>
      <td>create </td>
      <td>none [2]</td>
      <td> <br>
      </td>
    </tr>
    <tr>
      <td>&lt;OSCARS-user&gt;</td>
      <td>reservations</td>
      <td>modify </td>
      <td>none
[2]</td>
      <td> <br>
      </td>
    </tr>
    <tr>
      <td>&lt;OSCARS-user&gt; </td>
      <td>reservations </td>
      <td>signal </td>
      <td>none
[2] </td>
      <td> <br>
      </td>
    </tr>
    <tr>
      <td>&lt;OSCARS-user&gt; </td>
      <td>subscriptions</td>
      <td>create</td>
      <td><br>
      </td>
      <td> <br>
      </td>
    </tr>
    <tr>
      <td>&lt;OSCARS-user&gt; </td>
      <td>subscriptions</td>
      <td>modify</td>
      <td><br>
      </td>
      <td> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">users</td>
      <td style="background-color: rgb(255, 255, 204);">query </td>
      <td style="background-color: rgb(255, 255, 204);">none
[1] </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">users</td>
      <td style="background-color: rgb(255, 255, 204);">modify </td>
      <td style="background-color: rgb(255, 255, 204);">none
[1] </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">reservations </td>
      <td style="background-color: rgb(255, 255, 204);">list </td>
      <td style="background-color: rgb(255, 255, 204);">all-users </td>
      <td style="background-color: rgb(255, 255, 204);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">reservations</td>
      <td style="background-color: rgb(255, 255, 204);">query </td>
      <td style="background-color: rgb(255, 255, 204);">all-users </td>
      <td style="background-color: rgb(255, 255, 204);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">reservations</td>
      <td style="background-color: rgb(255, 255, 204);">create </td>
      <td style="background-color: rgb(255, 255, 204);">specify-path-elements
      </td>
      <td style="background-color: rgb(255, 255, 204);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">reservations</td>
      <td style="background-color: rgb(255, 255, 204);">modify </td>
      <td style="background-color: rgb(255, 255, 204);">all-users </td>
      <td style="background-color: rgb(255, 255, 204);">true </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">reservations</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">modify<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">specify-path-elements<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">true<br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">reservations </td>
      <td style="background-color: rgb(255, 255, 204);">signal </td>
      <td style="background-color: rgb(255, 255, 204);">all-users </td>
      <td style="background-color: rgb(255, 255, 204);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">reservations </td>
      <td style="background-color: rgb(255, 255, 204);">signal </td>
      <td style="background-color: rgb(255, 255, 204);">unsafe-allowed </td>
      <td style="background-color: rgb(255, 255, 204);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;
      </td>
      <td style="background-color: rgb(255, 255, 204);">subscriptions </td>
      <td style="background-color: rgb(255, 255, 204);">create </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;
      </td>
      <td style="background-color: rgb(255, 255, 204);">subscriptions </td>
      <td style="background-color: rgb(255, 255, 204);">modify </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;
      </td>
      <td style="background-color: rgb(255, 255, 204);">domains </td>
      <td style="background-color: rgb(255, 255, 204);">view </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-engineer&gt;
      </td>
      <td style="background-color: rgb(255, 255, 204);">domains </td>
      <td style="background-color: rgb(255, 255, 204);">modify </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-service&gt;</td>
      <td style="background-color: rgb(255, 255, 255);">reservations </td>
      <td style="background-color: rgb(255, 255, 255);">list </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-service&gt;</td>
      <td style="background-color: rgb(255, 255, 255);">reservations</td>
      <td style="background-color: rgb(255, 255, 255);">query </td>
      <td style="background-color: rgb(255, 255, 255);">my-site </td>
      <td style="background-color: rgb(255, 255, 255);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-service&gt;</td>
      <td style="background-color: rgb(255, 255, 255);">reservations</td>
      <td style="background-color: rgb(255, 255, 255);">create </td>
      <td style="background-color: rgb(255, 255, 255);">specify-path-elements
      </td>
      <td style="background-color: rgb(255, 255, 255);">true </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">&lt;OSCARS-service&gt;</td>
      <td style="vertical-align: top;">reservations</td>
      <td style="vertical-align: top;">create<br>
      </td>
      <td style="vertical-align: top;">specify-gri<br>
      </td>
      <td style="vertical-align: top;">true<br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-service&gt;</td>
      <td style="background-color: rgb(255, 255, 255);">reservations</td>
      <td style="background-color: rgb(255, 255, 255);">modify </td>
      <td style="background-color: rgb(255, 255, 255);">
specify-path-elements<br>
      </td>
      <td style="background-color: rgb(255, 255, 255);">true<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">&lt;OSCARS-service&gt;</td>
      <td style="vertical-align: top;">reservations</td>
      <td style="vertical-align: top;">modify<br>
      </td>
      <td style="vertical-align: top;">specify-gri</td>
      <td style="vertical-align: top;">true<br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-service&gt;</td>
      <td style="background-color: rgb(255, 255, 255);">reservations </td>
      <td style="background-color: rgb(255, 255, 255);">signal </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-service&gt;
      </td>
      <td style="background-color: rgb(255, 255, 255);">domains </td>
      <td style="background-color: rgb(255, 255, 255);">view </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-service&gt;
      </td>
      <td style="background-color: rgb(255, 255, 255);">domains </td>
      <td style="background-color: rgb(255, 255, 255);">modify </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-service&gt;
      </td>
      <td style="background-color: rgb(255, 255, 255);">subscriptions </td>
      <td style="background-color: rgb(255, 255, 255);">create </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-service&gt;
      </td>
      <td style="background-color: rgb(255, 255, 255);">subscriptions </td>
      <td style="background-color: rgb(255, 255, 255);">modify </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">&lt;OSCARS-service&gt;</td>
      <td style="vertical-align: top;">publishers<br>
      </td>
      <td style="vertical-align: top;">create<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">&lt;OSCARS-servicer&gt;</td>
      <td style="vertical-align: top;">publishers<br>
      </td>
      <td style="vertical-align: top;">modify<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">&lt;OSCARS-operator&gt;</td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">users<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">list<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">all-users<br>
      </td>
      <td
 style="vertical-align: top; background-color: rgb(255, 255, 204);">true<br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-operator&gt;
      </td>
      <td style="background-color: rgb(255, 255, 204);">users </td>
      <td style="background-color: rgb(255, 255, 204);">query </td>
      <td style="background-color: rgb(255, 255, 204);">none [1] </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-operator&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">users</td>
      <td style="background-color: rgb(255, 255, 204);">modify </td>
      <td style="background-color: rgb(255, 255, 204);">none [1] </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-operator&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">reservations </td>
      <td style="background-color: rgb(255, 255, 204);">list </td>
      <td style="background-color: rgb(255, 255, 204);">all-users</td>
      <td style="background-color: rgb(255, 255, 204);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-operator&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">reservations</td>
      <td style="background-color: rgb(255, 255, 204);">query </td>
      <td style="background-color: rgb(255, 255, 204);">all-users</td>
      <td style="background-color: rgb(255, 255, 204);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-operator&gt;
      </td>
      <td style="background-color: rgb(255, 255, 204);">subscriptions</td>
      <td style="background-color: rgb(255, 255, 204);">create</td>
      <td style="background-color: rgb(255, 255, 204);"><br>
      </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-operator&gt;
      </td>
      <td style="background-color: rgb(255, 255, 204);">subscriptions</td>
      <td style="background-color: rgb(255, 255, 204);">modify</td>
      <td style="background-color: rgb(255, 255, 204);"><br>
      </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-site-administrator&gt;
      </td>
      <td style="background-color: rgb(255, 255, 255);">reservations </td>
      <td style="background-color: rgb(255, 255, 255);">list </td>
      <td style="background-color: rgb(255, 255, 255);">my-site </td>
      <td style="background-color: rgb(255, 255, 255);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-site-administrator&gt;</td>
      <td style="background-color: rgb(255, 255, 255);">reservations</td>
      <td style="background-color: rgb(255, 255, 255);">query </td>
      <td style="background-color: rgb(255, 255, 255);">my-site </td>
      <td style="background-color: rgb(255, 255, 255);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-site-administrator&gt;</td>
      <td style="background-color: rgb(255, 255, 255);">reservations</td>
      <td style="background-color: rgb(255, 255, 255);">modify </td>
      <td style="background-color: rgb(255, 255, 255);">my-site </td>
      <td style="background-color: rgb(255, 255, 255);">true </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">&lt;OSCARS-site-administrator&gt;</td>
      <td style="vertical-align: top;">reservations<br>
      </td>
      <td style="vertical-align: top;">create<br>
      </td>
      <td style="vertical-align: top;">my-site<br>
      </td>
      <td style="vertical-align: top;">true<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">&lt;OSCARS-site-administrator&gt;</td>
      <td style="vertical-align: top;">reservations<br>
      </td>
      <td style="vertical-align: top;">signal<br>
      </td>
      <td style="vertical-align: top;">my-site<br>
      </td>
      <td style="vertical-align: top;">true<br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-site-administrator&gt;</td>
      <td style="background-color: rgb(255, 255, 255);">subscriptions</td>
      <td style="background-color: rgb(255, 255, 255);">create </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-site-administrator&gt;</td>
      <td style="background-color: rgb(255, 255, 255);">subscriptions</td>
      <td style="background-color: rgb(255, 255, 255);">modify </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-administrator&gt;
      </td>
      <td style="background-color: rgb(255, 255, 204);">users </td>
      <td style="background-color: rgb(255, 255, 204);">list </td>
      <td style="background-color: rgb(255, 255, 204);">all-users </td>
      <td style="background-color: rgb(255, 255, 204);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-administrator&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">users</td>
      <td style="background-color: rgb(255, 255, 204);">query </td>
      <td style="background-color: rgb(255, 255, 204);">all-users</td>
      <td style="background-color: rgb(255, 255, 204);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-administrator&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">users</td>
      <td style="background-color: rgb(255, 255, 204);">modify </td>
      <td style="background-color: rgb(255, 255, 204);">all-users</td>
      <td style="background-color: rgb(255, 255, 204);">true </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-administrator&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">users </td>
      <td style="background-color: rgb(255, 255, 204);">create </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-administrator&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">AAA </td>
      <td style="background-color: rgb(255, 255, 204);">list </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-administrator&gt;</td>
      <td style="background-color: rgb(255, 255, 204);">AAA</td>
      <td style="background-color: rgb(255, 255, 204);">modify</td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-administrator&gt;
      </td>
      <td style="background-color: rgb(255, 255, 204);">subscriptions</td>
      <td style="background-color: rgb(255, 255, 204);">modify</td>
      <td style="background-color: rgb(255, 255, 204);"><br>
      </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 204);">&lt;OSCARS-administrator&gt;
      </td>
      <td style="background-color: rgb(255, 255, 204);">publishers</td>
      <td style="background-color: rgb(255, 255, 204);">modify</td>
      <td style="background-color: rgb(255, 255, 204);"><br>
      </td>
      <td style="background-color: rgb(255, 255, 204);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-publisher&gt;</td>
      <td style="background-color: rgb(255, 255, 255);">publishers</td>
      <td style="background-color: rgb(255, 255, 255);">create </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
    </tr>
    <tr>
      <td style="background-color: rgb(255, 255, 255);">&lt;OSCARS-publisher&gt;</td>
      <td style="background-color: rgb(255, 255, 255);">publishers</td>
      <td style="background-color: rgb(255, 255, 255);">modify </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
      <td style="background-color: rgb(255, 255, 255);"> <br>
      </td>
    </tr>
    <tr>
    </tr>
  </tbody>
</table>
<br>
Defaults<br>
[1] manage and view only his own user info<br>
[2] unlimited bandwidth and duration, only modify, list, query and
signal own
reservations, not input path components.<br>
<br>
An
OSCARS-engineer can make reservations, see, modify and signal all
reservations, including correcting potential errors in the reservation
tables, can only see and modify his own user information,
and has free rein over the topology. An OSCARS operator can view
everybody's
reservations and can see and modify only his own user
information. An OSCARS user can make reservations of unlimited
bandwidth
and duration, view, modify and signal his own reservations and see and
modify his own user information.
An OSCARS admin can manage all user information, but not see or modify
reservations. <br>
<br>
<h2><a class="mozTocH2" name="mozTocId625591"></a>API for access checks<br>
</h2>
<ol id="mozToc">
<!--mozToc h2 1 h3 2 h3 3 h4 4 h5 5 h6 6-->
</ol>
<h3><a class="mozTocH3" name="mozTocId804096"></a>CheckAccess
Implementation</h3>
The preferred way to implement access control is to isolate the access
checking in one place, called the PolicyDecisionPoint that returns a
permit or deny response and is called by all access control
points (aka Policy Enforcement Points/ PEP) to see if an action is
authorized. The AAA/UserManager class provides two methods for
access checking. The first is called any place where a reservation
is not being modified and the second by createReservation and
modifyReservation.<br>
<br style="font-weight: bold;">
<h3><a class="mozTocH3" name="mozTocId305904"></a><span
 style="font-weight: bold;">Standard method</span></h3>
<span style="font-weight: bold;"><br>
</span><small><code style="font-weight: bold;"><big>AuthValue
UserManager.checkAccess(String user, String resource, String
permission);</big></code></small>
<p>Initialize the return value to DENIED<br>
Lookup user in userAttribute table to get list of all attributes<br>
For each attribute lookup (attrId,resource,permission) in
authorization table.
</p>
<ul>
  <li>If deny is returned, continue<br>
  </li>
  <li>If there is no constraint, remember
SELFONLY and continue<br>
  </li>
  <li>If all-users=true is returned, return ALLUSERS<br>
  </li>
  <li>If all-users=false is returned, remember
SELFONLY and continue<br>
  </li>
  <li>If my-site constraint is found remember SITEONLY and
continue </li>
</ul>
At end of loop check for SELFONLY and/or MYSITE<br>
Return DENIED, SELFONLY, SITEONLY
<h3><a class="mozTocH3" name="mozTocId364346"></a><span
 style="font-weight: bold;">Method for
create and modify reservations</span></h3>
<code style="font-weight: bold;"><br>
AuthValue
UserManager.checkModResAccess(String user,String resource,
String permission, int ReqBandWidth, int ReqDuration, Boolean
specify-path-elements);</code><br>
<p><br>
Start out with<br>
&nbsp;&nbsp;&nbsp; ReturnValue = DENIED<br>
&nbsp;&nbsp;&nbsp; bandwidthOK = false<br>
&nbsp;&nbsp;&nbsp; maxdurationOK = false<br>
&nbsp;&nbsp;&nbsp; specPathElemsOK = false.<br>
Look up user in userAttributes table and get a list of attributes for
this user.<br>
For each attribute look up Authorization(AttrId,resource,permission) <br>
&nbsp;&nbsp; if an authorization returned<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if the constraint is
null <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mark
bandwidthOK=true and durationOK=true, <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; and
returnValue=SELFONLY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if the constraint is max-bandwidth
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mark
bandwidthOK= true if&nbsp; reqBandwidth &lt; constraintValue<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if constraint is max-duration<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mark
durationOK if reqDuration &lt; constraintValue<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if constraint is specify-path-elements<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; mark
specPathElemsOK = true<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if constraint is all-users<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; if value == 1
set returnValue = ALLUSERS<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if value == 0
set returnValue = SELFONLY<br>
At the end of the attribute list<br>
&nbsp;&nbsp; if bandwidthOK == false or maxdurationOK == false<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return DENIED<br>
if specify-path-element= true and specPathElemsOK == false<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return DENIED<br>
otherwise return ReturnValue<br>
<!--#include virtual="footer.html" -->
</p>
</body>
</html>
