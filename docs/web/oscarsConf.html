<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>Axis configuration</title>
  <base href="/docs">
  <link rel="stylesheet" href="styleSheets/oscars.css" type="text/css">
  <link rel="shortcut icon" href="images/esnet.ico" type="image/x-icon">
</head>
<body>
<!--#include virtual="header.html" -->
<div id="topBar" class="topBar">
<div class="topBarDiv"> &nbsp;
<a href="index.html">home</a> &gt; <a href="install.html">Install
OSCARS</a>
&gt; <a href="oscarsConf.html">OSCARS Configuration</a>
</div>
</div>
<h2>OSCARS Configuration</h2>
<span style="font-weight: normal;">You will need to modify
the files that are located in conf/examples/server,client for your
users. Once you have modified them you should copy them to a domain
specific directory, and set the environment variable DOMAIN_HOME to
point to them. If $DOMAIN_HOME is set, the ant task setupServer will
copy the files from there rather than the conf/examples. Also when you
update to a newer distribution of OSCARS your changes won't be lost.</span><br>
<h3>Server</h3>
<ul>
  <li><b>services.xml</b>
is generated by WSDL2Java and specifies all the methods and their
parameters.
The security inFlow and outFlow parameters have been added to this
file. The&nbsp; name of the sec-properties file is given here. Located
in the distribution at conf/server. Copied to OSCARS.aar/META-INF/. </li>
  <li><b>sec-server.properties</b>
names the keystore file and has its
password. Located in the distribution in conf/examples/server. Copied
to $CATALINA_HOME/shared/server/classes.<br>
  </li>
  <li><b>sec-server.jks</b>
has
the keystore that is used by rampart to
verify signed messages. It only needs to contain the trustedCaCerts for
the issuers of any user who will submit a signed message. Located in
the distribution in conf/examples/server. Copied to
$CATALINA_HOME/shared/server/classes.</li>
  <li>Files copied from OSCARS to axis2</li>
  <ul>
    <li>conf/server/axis2.log4j.properties is copied to
webapps/axis2/classes/log4j.properties</li>
    <li>classes/net/es/oscars/client/security/PWCallback.class copied
to webapps/axis2/WEB-INF/net/es/oscars/client/security/PWCallback.class<br>
    </li>
  </ul>
</ul>
<h3><a name="server-client">Server acting as client</a></h3>
When the server forwards a request to another domain, it acts as a
OSCARS/axis2 client and thus needs to include te client-side
configuration files. These files are put into
$CATALINA_HOME/shared/classes/repo.
<p>The location of the axis2.xml file and the repository in which the
modules are found are set in Forwarder.setup. Forwarder.setup calls
KeyMangement.setKeyStore which sets the ssl keystore to the
file "ssl-keystore.jks" in the repository directory. </p>
<p>axis2.xml defines the names of the signatureProperty file and the
keystore.
</p>
<p>The files sec-client.properties, sec-client.jks and ssl-keystore.jks
are also
copied to $CATALINA_HOME/shared/classes/repo so that they will be on
the server's classpath.<br>
<br>
</p>
<h3>Client</h3>
See <a href="msgSecurity.html">Security
Reference</a> for more
details about these files.<br>
<ul>
  <li><b>axis2.xml</b> - needed when
signing messages. It contains:</li>
  <ul>
    <li>InFlow and OutFlow parameters</li>
    <li>Name of the client-properties file</li>
  </ul>
  <br>
The axis2.xml file can be found by the client code from a
javavm flag -daxis2.xml=&lt;filename&gt; <br>
or can be set programatically by <br>
  <pre>ConfigurationContext configContext = <br>		ConfigurationContextFactory.createConfigurationContextFromFileSystem(repo, null);<br>ServiceClient serviceClient = new ServiceClient(configContext, null)</pre>
Where <b>repo</b> is a directory on the classpath that contains a
conf/axis2.xml file.<br>
  <br>
The repo directory also contains: <li><b>sec-client.properties</b>
contains:
    <ul>
      <li>org.apache.ws.security.crypto.provider=org.apache.ws.security.components.crypto.Merlin
      </li>
      <li>org.apache.ws.security.crypto.merlin.keystore.type=jks </li>
      <li>org.apache.ws.security.crypto.merlin.keystore.password=password
      </li>
      <li>.apache.ws.security.crypto.merlin.file=sec-client.jks (name
of keystore file)</li>
    </ul>
  </li>
  <li><b>sec-client-key.jks</b>
contains</li>
  <ul>
    <li>keyentry for the user specified in axis2.xml to be signing
the outgoing messages</li>
    <li>trustedCaCerts for the issuer of this user's certificate <br>
    </li>
  </ul>
  <li><b>ssl-keystore.jks </b>- has
the certificate and issuer for the ssl
certificate of the oscars services to which the client will be
connecting </li>
</ul>
<!--#include virtual="footer.html" -->
</body>
</html>
