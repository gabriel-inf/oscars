<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>Installing OSCARS</title>
  <link rel="stylesheet" href="styleSheets/oscars.css" type="text/css">
  <link rel="shortcut icon" href="images/esnet.ico" type="image/x-icon">
</head>
<body>
<!--#include virtual="header.html" -->
<div id="topBar" class="topBar">
<div class="topBarDiv"> &nbsp; <a href="index.html">home</a> &gt; <a
 href="install.html">Install</a> &gt; <a href="msgSecurity.html">Message
Security</a> &gt; <a href="keytool.html">Using Keytool</a>
</div>
</div>
<br>
<h2>Managing a Java keystore</h2>
<p>The keytool command is part of the&nbsp; Java 2 JDK release.
Complete documentation can be found at <a
 href="http://java.sun.com/j2se/1.3/docs/tooldocs/win32/keytool.html">sun-keytool.html</a>.
The keytool command will do most of what you need: listing contents,
setting aliases, adding new trust certificates. The one thing it does
not
do (prior to Java 6) is to import a trusted entry, e.g. cert and key.<br>
</p>
<p>OSCARS provides wrappers in <a href="msgSecurity.html#idcCommands">tools/utils</a>
that simplify the use keytool by suggesting the location of the
keystore and finding the password from the related configuration file.
These wrappers should be used to edit
$CATALINA_HOME/shared/classes/repo/{OSCARS.jks, ssl-keystore.jks}. You
can use keytool to edit keystores in other locations.<br>
</p>
<h3>Finding an CA certificate</h3>
Ask whoever is running the service that you want
to connect to, to send you the CA certificate that signed its web site
certificate. Then enter that in your ssl-keystore.<br>
<br>
<span style="font-weight: bold;">Get the site certificate</span><br>
<br>
Another approach is to get the site certificate and use that instead.
Connect to
the service with your browser using https and then export the
certificate from your browser.<br>
<br>
In IE the following is reputed to work.<br>
<br>
<i>View certificate -&gt; certificate details -&gt;</i> <i>copy to file</i>
<br>
<br>
For Firefox you may need the following extension.<br>
<br>
https://addons.mozilla.org/en-US/firefox/addon/1964<br>
<br>
Once this is installed there will be a "certificate Manager" entry in
the tools menu.
<br>
<br>
<span style="font-style: italic;">tools -&gt; websites -&gt; select
certificate -&gt; view -&gt; export</span><br>
<br>
<h3>Input a site or CA certifcate as a trustedCertEntry</h3>
<br>
You need to have the x.509 certificate of the CA in pem format (tagged
ascii base-64 encoded). To convert from a DER format (binary) use
openssl:<br>
<pre style="font-weight: bold;">openssl x509 -in <span
 style="font-style: italic;">'CAcert.der'</span> -inform DER -outform PEM -out <span
 style="font-style: italic;">'CAcert.pem'</span></pre>
To import into a keystore:<br>
<br>
<span style="font-weight: bold;">tools/users/idc-certadd&nbsp;</span> <br>
<br>
or <br>
<pre style="font-weight: bold;">keytool -import -keystore <span
 style="font-style: italic;">'OSCARS.jks'</span> -file <span
 style="font-style: italic;">'CAcert.pem'</span> -trustcacerts -alias <span
 style="font-style: italic;">'CA'</span></pre>
<h4>Addin existing keyEntries to your OSCARS.jks keystore.<br>
</h4>
<span style="font-weight: bold;">tools/utils/copyKey:<br>
</span>Used to copy a keyEntry from one keystore to another. Useful
when upgrading from DCN release 0.3 to 0.4 or when importing a keyEntry
from an externally obtained pkcs12 file.<br>
<br>
<code>copyKey.sh -a &lt;alias of keyEntry&gt; <br>
[-inpkcs12 &lt;filename of input
keyStore&gt;&nbsp; | -injks </code><code>&lt;filename of input
keyStore&gt; ]</code><br>
<code>-out &lt;filename of output keystore&gt;<br>
<br>
</code>It will prompt for the password of the input keystore, the
password of the keyEntry in the input keystore and the password for the
output key store. Normally the password of a keyEntry is the same the
keystore. If this is the case just reply with a CR. If the -inpkcs12
option is used the entry will be imported from a pkcs12 file. If -injks
is used it will be imported from another jks keystore.
</body>
</html>
