<html>
<title>OSCARS Reservation Manager Functional Specification</title>
</head>
<body>
<h2>OSCARS Reservation Manager Functional Specification</h2>

<h3>Year 3 Update (DRAFT)</h3>

<em>David Robertson, Chin Guok</em><br/>
<a href="http://www.es.net">ESnet</a><br/><br/>

August 11, 2006<br/>

<h2>Objective</h2>

<p>To develop and deploy a new service that can provide secure guaranteed
bandwidth circuits within ESnet, and interoperate with reservation
servers in other domains.</p>

<h2>Introduction</h2>

<p><a href="http://www.es.net/oscars/">OSCARS</a> is an acronym for
On-Demand Secure Circuits and Advance Reservation System.  The focus of 
OSCARS is on facilitating bandwidth-intensive large scientific projects.</p>

<p>This document lists the requirements for the reservation manager (RM)
component of OSCARS, updated for year 3 of the project.  The requirements for 
the RM include setting up user accounts, setting up and tracking 
reservations and circuits, handling security and monitoring, and accounting.
Items with a (*) after them are scheduled to be done this year.  Items
with a (?) may or may not be implemented.</p>

<a id="security">
<p>Security is absolutely essential.  The impact of an abuse could be very
large.  A DoS attack could prevent reservations from being processed.  If the
service is compromised, and thus the routers it has access to, the WAN may be 
disabled.  Discussion of the security implications of requirements are 
postponed until the 
<a href="https://oscars.es.net/specs/fspec.html#security">section</a>
on security.</p>

<p>Current requirements are largely taken from Chin Guok's Powerpoint
presentations, the OSCARS project Web page, discussions with QoS/MPLS 
researchers at other DOE labs, 
<a href="http://www.internet2.edu">Internet2</a>, 
and 
<a href="http://www.geant2.net">G&Eacute;ANT2</a>, 
and from lessons learned thus far.
If possible, there may be code sharing/reuse between these researchers
and ESnet.  Additional security requirements have been arrived at through
discussion with researchers from the
<a href="http://dsd.lbl.gov/">Distributed Systems Department</a> of the
<a href="http://www.lbl.gov/">Lawrence Berkeley National Laboratory</a>.
</p>

<h3>Scope</h3>

<p>This document covers the requirements for the RM and its
clients.  The requirements for the other major component of
OSCARS, which handles the details of setting up the guaranteed bandwidth
circuit using MPLS and RSVP, are listed in the OSCARS
<a href="http://www.es.net/oscars/documents/OSCARS.pdf">full proposal</a>.</p>

<p>The RM must interoperate with other autonomous domains, to enable 
reservations where the end-to-end path may traverse several such domains.
Interdomain reservation setup is discussed in the
<a href="https://oscars.es.net/specs/fspec.html#nni">section</a>
on the network-to-network interface (NNI).</p>

<p>Specific design decisions are in a companion document,
the OSCARS RM <a href="dspec.html">design specification.</a></p>

<h3>Usability</h3>

<p>Installation and use must be easy as possible.
A standard, well-known mechanism to implement operations such as transport
and server capability, for example Tomcat or SOAP, is to be preferred.</p>

<h3>Modes of operation</h3>

<p>The manager must be able to run in conjunction with current ESnet
proprietary network management systems, as well as in a completely open source
mode that other organizations can incorporate and use without additional
licensing.</p>


<h2>Reservation manager</h2>

<p>The RM must have four subsystems:

<ol>
<li>An authentication, authorization, and accounting subsystem (AAA),<br/>
<li>A bandwidth scheduler subsystem (BSS),<br/>
<li>A path setup subsystem (PSS), and<br/>
<li>A client interface (both an interactive interface and an API).  The API
is allowed only where noted.
</ol>

<a id="require">
<h3>AAA</h3>

<p>The AAA must be used to authenticate and authorize all external requests,
whether from the interactive interface, or the API.
User account names must be globally unique.</p>

<p>In addition to the authentication
and authorization process, which may be handled via library calls or client
requests to other entities, the AAA handles a number of requests related to
its management.  These requests must only be accessible via test methods on
the machine where the OSCARS server is running, and via the interactive 
interface.  Parameters to these requests are listed in a section below.</p>

<ol>
<li>Request an OSCARS account (*).
</li><br/>

<li>Login to OSCARS.
</li><br/>

<p>The following requests must be handled from interactive clients that have 
successfully authenticated themselves, but require no additional
authorization:</p>

<li>List the details of the client's user profile.
</li><br/>

<li>Modify the details of the client's user account profile.
</li><br/>

<li>Request an allocation of bandwidth to use in making reservations (?).
</li><br/>

<li>List the client's current allocation and usage (?).
</li><br/>

<li>Logout from OSCARS.
</li><br/>

<p>
The following requests require that a user have the proper authorization:

<li>List all user accounts.
</li><br/>

<li>Modify any user account.
</li><br/>

<li>Add a user account.
</li><br/>

<li>Delete a user account.
</li><br/>

<li>List all OSCARS resources that may require authorizations to use (*).
</li><br/>

<li>List all users' authorizations (*).
</li><br/>

</ol>

<p>Requests related to the reservation of bandwidth are 
handled by the BSS, and are detailed in the next 
section.</p>

<h3>BSS</h3>

<p>The BSS must accept reservations, keep track of 
reservations, and maintain information necessary for future reservations:</p>

<ul>
<li>It must maintain a calendaring system to avoid conflicts in
reservations (*).<br/><br/>

<li>It must determine the path that will be taken, and reserve bandwidth
on the links.  Just prior to the reservation time, it must invoke the
PSS to set up the circuit.  It must also trigger the teardown
of the circuit when the reservation has expired.<br/><br/>

<li>It must estimate future availability of circuits based on current
and archived network statistics (?).<br/><br/>

<li>It must take into account scheduled maintenance and track unplanned outages.
If there is a new scheduled outage that conflicts with a reservation already
made, or if there is an unplanned outage on one of the interfaces in that path,
the BSS must retrieve the current topology, and determine a possible new
path(s) (*).<br/><br/>
</ul>

<p>The BSS must maintain policies associated with the scheduling and actual
use of the network, detect any out-of-policy usage, and enforce the policies
that are not handled by network management tools at the router level.
Enforcement at the router level is not in the scope of this document, but
information that may be necessary for such enforcement
should be communicated to the PSS.</p>

<ul>
<li>Policies must be in place to avoid any interference by the OSCARS system
with production traffic.  These may include those intended to prevent
monopolization of the OSCARS service (done), and those dictating pre-emption of 
an existing reservation to resolve resource reservation conflicts due to 
network outages (*).
</li><br/>

<li>The bandwidth used by an application must be compared against that
requested in the application's reservation.  If the bandwidth used by
the application is over any limit, the BSS must determine whether to
enforce the relevant policy. (enforcement, but not decision-making done)
</li><br/>

<li>The total bandwidth consumed at any link involved in currently active 
OSCARS reservations must be tracked, and if total bandwidth is over the limit, 
the BSS must handle policy enforcement.
</li><br/>

<li>If there is an outage, the BSS must determine the policy to use, which
may include limiting new reservations or revising existing reservations
during that time period.  It may also involve
making a request to the PSS to remove the previous circuit and set
the circuit to an alternative path (*).<br/><br/>

</ul>

<p>The BSS must handle the following client requests, whether via the API or the interactive interface, after authentication by the AAA:</p>

<ol>
<li>Schedule bandwidth reservation.
</li><br/>

<li>List the client's reservations.
</li><br/>

<li>List the details of a reservation the client has made.
</li><br/>

<li>Cancel a reservation the client has made.
</li><br/>

<li>Modify a reservation the client has made (*).
</li><br/>
 
The following requests require that a user have additional authorization(s):
</p>

<li>List all clients' reservations.
</li><br/>

<li>List the details of any client's reservation.
</li><br/>

<li>Cancel a reservation that any client has made.
</li><br/>

<li>Modify a reservation that any client has made (*).
</li><br/>
 
</ol>

<a id="notifications">
<p>The following notifications must be made to clients, and must include the 
status of a reservation, the bandwidth allocated, and the QoS value:</p>

<ul>
<li>A reservation has been successfully placed.
</li><br/>

<li>A reservation has been changed or cancelled (*).
</li><br/>

<li>An LSP circuit has been set up, and the status of that setup.
</li><br/>

<li>An LSP circuit has been torn down, and the status of that teardown 
(done), including the total packets/bytes forwarded (*).
</li><br/>

<li>A reservation has been terminated that was not in compliance with 
policy (*).
</li><br/>
</ul>

<h3>PSS</h3>

<p>The PSS must set up and tear down the on-demand circuits on
the appropriate routers, based on a request by the BSS.  To do so, it must
change the router configuration on the start and end of the circuit.</p>

<p>Prior to circuit setup, the PSS must validate the route to use, and
query routers along the path to check for "illegal" active circuits that could
conflict with bandwidth reservation (*).</p>


<h3>User interface</h3>

<p>The user interface must provide means for making all requests listed in the 
sections on the AAA and BSS.  Client requests generated by either interactive 
or automated means must use the same transport and message encoding 
(for example, SOAP) to communicate with the RM.</p>

<p>The API for automated reservations by user applications should utilize
well-known mechanisms.  A service description must be provided that will allow 
automated use of the API (AAA portion remains to be done).</p>

<p>The interactive interface must be simple and intuitive.  It must prompt a 
user for a credential (username/password) before allowing any 
requests.  It must in general operate within the trusted domain of the 
reservations manager.</p>

<p>After login, the interactive interface must provide entry forms to gather 
the information for requests, which may require an additional step of sending 
the information gathered as a message to the RM.  Several requests may 
be combined on a single entry form.</p>

<p>For each mandatory and optional argument listed below, an entry form must 
have corresponding input fields and/or interactive controls.  The entry form 
must not include input fields corresponding to arguments requiring special 
authorizations, if the client does not have the proper authorization.  There 
must be an area on each entry form for status and error messages, which 
must be updated after each request.</p>

<p>All parameters must be validated on the client side before sending
a request to the RM, to avoid unnecessary waiting time for the
client if there is an error.</p>

<p>The following sections list the mandatory and optional arguments for each 
request, and the results returned, if any.</p>


<h4>AAA requests</h4>

<ol>
<li>Request by a client for an OSCARS account (*):</br/><br/>

The arguments are the same as those for the request to modify a user's account 
profile, listed below, except for the absence of the current password.
</li><br/>

<li>Login to OSCARS:<br/><br/>

A login name and a credential are mandatory arguments.  For the interactive 
interface, general OSCARS information should be readily available after login.
</li><br/>

<li>List the client's user profile:<br/><br/>

A listing must be returned from this request that includes the user's
unique id, first name, last name, organizational membership, personal
description, primary and secondary email addresses, and primary and
secondary phone numbers.  The personal description, and secondary email and
phone numbers are permitted to be empty.
</li><br/>

<li>Modify the client's user profile:<br/><br/>

The user's current password is a mandatory argument.  If the password
is to be modified, arguments for the new password, listed twice, are
mandatory.  The user's first name, last name, organizational membership,
primary email address, and primary phone number are mandatory arguments.
The user's personal description, secondary email address, and secondary
phone number are optional arguments.
</li><br/>

<li>Request for an allocation to use in making reservations (?):<br/><br/>

TBD.
</li><br/>

<li>List a client's current allocation and usage (?):<br/><br/>

TBD.
</li><br/>

<li>Logout from OSCARS:<br/><br/>

In the interactive interface, the returned page must be the initial login
page.
</li><br/>

<p>The following requests require additional authorization:</p>

<li>List all user accounts:<br/><br/>

The listing returned from the request must include each user's last name,
first name, unique identifier,  organizational membership,
and current login status.
</li><br/>

<li>Modify any user account:<br/><br/>

Same as request to modify a user's account profile, except that it can be
done for any user's account.
</li><br/>

<li>Add a user account:<br/><br/>

The arguments are the same as those for the request to modify a user's account 
profile, listed above, except for the absence of the current password.
</li><br/>

<li>Delete a user account:<br/><br/>

The user's unique login is a mandatory argument.
</li><br/>

<li>Edit/list all resources requiring authorizations (*):<br/><br/>

No arguments are necessary for this method.
</li><br/>

<li>Edit/list all users' authorizations (*):<br/><br/>

No arguments are necessary for this method.
</li>
</ol>

<a id="resv">
<h4>BSS requests</h4>

<ol>
<li>Schedule bandwidth reservation:<br/>

<p>The reservation's source, destination, and requested bandwidth, and the 
purpose of the reservation are mandatory arguments.  The reservation's start 
time, duration, source and destination ports, the protocol to use, the DSCP 
bit(s), the ingress and egress loopbacks, and the start time and duration are 
optional arguments.  Default values must be used for the start time and
duration if these arguments are empty.</p>

<p>There must be an authorization that can be associated with a user, which is 
required for use of the following arguments: a traceroute listing, and
flags for the setup of a persistent circuit and a bidirectional path.</p>

<p>A disclaimer must be present on the interactive form 
indicating that if the transit path across ESnet has more than 
one ingress point, a full traceroute must be provided to ensure that the 
requested bandwidth along the actual path is available (*).</p>

<p>Upon successful reservation setup, a listing must be returned with the
reservation details.
</li><br/>

<li>List the client's reservations:<br/><br/>

A listing of that client's current, finished, and cancelled reservations must 
be returned as a result of the request.  Each item in the list must include the
unique tag for the reservation, and the start time, end time, status, origin, 
and destination.
</li><br/>

<li>Provide a search filter for the reservations list:<br/><br/>

A search filter method, or an interactive element, must be provided to 
narrow the reservations listed, for example by a specific date (*).
</li><br/>

<li>List the details of a reservation the client has made:<br/><br/>

A listing of that reservation's details must be returned as a result of the 
request.  This information must include the reservation's tag, the unique user
login of the client that made the reservation, and the reservation's 
description, start time, end time,
creation time, bandwidth, burst limit, status, source, destination,
source port, destination port, protocol, DSCP bit(s), and class.  If the
request was from an authorized engineer, the information must also include the
reservation's ingress router and loopback, egress router and loopback, and
the routers in the path traversing ESnet.  
</li><br/>

<li>Cancel a reservation the client has made:<br/><br/>

An API method or interactive element must be provided to cancel a reservation 
identified by its reservation tag.
</li><br/>

<li> Modify a reservation the client has made (*):<br/><br/>
An API method or interactive element must be provided to modify a reservation 
identified by its reservation tag.  Modifiable arguments must include the 
reservation start and end time, and start and destination of the path.
</li><br/>

<p>The following requests require additional authorization:</p>

<li>List of all reservations:<br/><br/>

Same as the request for a client's reservation, except that the listing
includes all reservations.
</li><br/>

<li>List the details of any client's reservation:<br/><br/>

Same as the request for details of a client's reservation, except that the 
details can be of any client's reservation.
</li><br/>

<li>Cancel a reservation that any client has made:<br/><br/>

Same as the request by a client for the cancellation of that client's 
reservation, except that any reservation from any client may be cancelled.
</li><br/>

<li>Modify a reservation that any client has made (*):<br/><br/>

Same as the request by a client for the modification of that client's 
reservation, except that any reservation from any client may be modified.
</li><br/>

</ol>

<a id="nni">
<h2>NNI</h2>

<p>The RM handles mostly intradomain functionality, but the interdomain
aspect is crucial.  The RM must determine if it is necessary to contact 
another domain to complete a request.  If so, the RM must forward that 
request to the other domain, and handle the response (partially
implemented).</p>

<p>To do so, there must be a standards-based interface for the RM's of 
different domains to communicate reservation requests.  The RM of one domain 
must be able to interoperate with the RM's of other autonomous domains. 
High-bandwidth reservations will be needed, for example by 
<a href="http://lhc.web.cern.ch/lhc/">LHC</a> 
users, that traverse multiple domains.  This requirement is at a higher
level than the OSCARS specification, but it is a requirement of this
specification that such an interface, when agreed upon, be 
implemented (*).</p>

<p>In addition, the AAA must have a mechanism for trusting other domains.  
It must forward necessary certificates or tokens to the AAA's of other 
domains to authenticate a client, and assertions to authorize a client to 
use a domain's RM.  The AAA must interoperate with another trusted AAA, even
if that system uses a different means of authentication or authorization.</p>

<a id="security_r">
<h2>Security</h2>

<p>The administration of an end-to-end circuit must conform to security
models of all entities along that path.  In particular, stages leading
towards the rollout of the service must follow the guidelines in the 
ESnet Security Plan (*).</p>

<p>OSCARS security mechanisms must be as easy to install and use as
possible, as long as security is not compromised.  A difficult to use system
will not be used.</p>

<p> The machine(s) running the AAA, BSS, and PSS must be inside a protected 
network.  The interactive interface must access these components via
an identifier (for example a URL) that does not give the location of the
server machine(s).</p>

<p>Access to OSCARS must require authentication and authorization.
The AAA must authorize and authenticate all OSCARS requests from outside the 
protected network, and enforce these restrictions.</p>

<p>The AAA must generate usage records for all accesses, for auditing
and accounting (?).

<p>OSCARS accounts must be provided for administrators and the appropriate
ESnet personnel, and only users with those accounts can have additional OSCARS
authorizations.  These authorizations, allowing different 
levels of access, must be maintained and enforced.</p>

<p>Automated messages to OSCARS must be signed and encrypted.  
Automated access does not necessarily require an OSCARS account, if it does 
not require the above-mentioned authorizations.  A valid server certificate 
is sufficient if the request is coming from a reservations manager from
another, trusted autonomous domain.</p>

<p>A secure means must be provided to store authentication information during
login through the interactive client, to avoid that client having to 
authenticate for each subsequent access to OSCARS.</p>

<p>Request parameters must be validated on the server side,
whether the client is the API or the interactive interface.</p>

<p>All components of the service must be monitored to ensure that they are
not being abused.  
<a href="https://oscars.es.net/specs/fspec.html#notifications">
Notifications</a> 
of sensitive operations such as reservation 
scheduling and LSP setup must be sent to the appropriate ESnet personnel,
in addition to the client.</p>

</body>
</html>


